<!DOCTYPE html>
<html>

<head>
  <title>COLOBODO协作平台</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="../my-styles/style.css">
  <link rel="shortcut icon" href="./favicon.ico" />
</head>

<body>
  <img style="display:none;" id='defaultavatar' src='../assets/avatar/avatar-0.svg' />
  <div id="overallbackground" class="grid1"></div>
  <div id='app' class='fontFancyColor'>
    <div id="firstpage">
      <div v-show="show.section.signin || show.section.register">
        <b-button pill variant='success' class='signin-button-tr' :size="show.section.register?'sm':'md'"
          @click="KFK.gotoRegister">注 册</b-button>
        <b-button pill variant='success' class='register-button-tr' :size="show.section.signin?'sm':'md'"
          @click="KFK.gotoSignin">登 录</b-button>
      </div>
      <div class="text-center msgarea" id="MSG">
      </div>
      <img v-show="!show.section.designer" src="../assets/cocopad.svg" class='left_top_logo_image' />
      <div class="cocoslogon" v-show="!show.section.designer" />
      <b-row class="text-center py-0">
        <b-col style='font-size: 28px;'>协作白板</b-col>
      </b-row>
      <b-row class="text-center" v-show="!show.section.designer" class="m-0 p-0">
        <b-col style='font-size:18px;'>在线共创 高效沟通</b-col>
      </b-row>
    </div> <!-- first page-->
    <div class="leftbkg" v-show="!show.section.designer">
      <div class='left_menu noshow' v-show="show.section.register || show.section.signin" id="left_menu">
        <b-container>
          <b-row class="text-center mt-5">
            <b-col> <img src="../assets/brainstorm.svg" class='left_top_image' /> </b-col>
          </b-row>
          <b-row class="text-center py-1">
            <b-col style='font-size:18px;'> 头脑风暴 </b-col>
          </b-row>
          <b-row class="text-center mt-2">
            <b-col> <img src="../assets/home_office.svg" class='left_top_image' /> </b-col>
          </b-row>
          <b-row class="text-center py-1">
            <b-col style='font-size:18px;'> 远程办公 </b-col>
          </b-row>
          <b-row class="text-center mt-2">
            <b-col> <img src="../assets/meetingroom.svg" class='left_top_image' /> </b-col>
          </b-row>
          <b-row class="text-center py-1">
            <b-col style='font-size:18px;'> 在线会议 </b-col>
          </b-row>
          <b-row class="text-center mt-2">
            <b-col> <img src="../assets/design.svg" class='left_top_image' /> </b-col>
          </b-row>
          <b-row class="text-center py-1">
            <b-col style='font-size:18px;'> 联合设计 </b-col>
          </b-row>
          <b-row class="text-center mt-2">
            <b-col> <img src="../assets/collaboration.svg" class='left_top_image' /> </b-col>
          </b-row>
          <b-row class="text-center py-1">
            <b-col style='font-size:18px;'> 在线协作 </b-col>
          </b-row>
          <b-row class="text-center mt-2">
            <b-col> <img src="../assets/classroom.svg" class='left_top_image' /> </b-col>
          </b-row>
          <b-row class="text-center py-1">
            <b-col style='font-size:18px;'> 远程教学 </b-col>
          </b-row>
          <b-row class="text-center mt-2">
            <b-col> <img src="../assets/km.svg" class='left_top_image' /> </b-col>
          </b-row>
          <b-row class="text-center py-1">
            <b-col style='font-size:18px;'> 知识管理 </b-col>
          </b-row>
        </b-container>
      </div>
    </div> <!-- leftbkg-->
    <div id="waiting" v-show="show.waiting" class="waitinglogo">
      <b-container>
        <b-row cols="3" align-v='center'>
          <b-col>
            <b-iconstack font-scale="6">
              <b-icon stacked icon="cloud" variant="info" scale="1.5"></b-icon>
              <b-icon stacked icon="three-dots" variant="danger" scale="0.8" shift-v="-2.5" animation="cylon"></b-icon>
            </b-iconstack>
          </b-col>
          <b-col>
            <b-icon icon="three-dots" animation="cylon" font-scale="3" color="#7952b3"></b-icon>
          </b-col>
          <b-col>
            <img src="../assets/cocopad.svg" class="logo d-inline-block align-top" alt="COLOBODO">
          </b-col>
        </b-row>
      </b-container>
    </div><!-- waiting-->
    <div id="registerform" class="registerform" v-show="show.section.register" style="display:none;">
        <b-form autocomplete="off" class="w-100 text-center px-2">
          <div v-show="model.register.step==='reg'">
            <b-row>
              <b-col class="pb-4" style="font-size:28px">
                新用户注册
              </b-col>
            </b-row>
            <b-input-group prepend="注册账号" class="mb-1">
              <b-form-input id="regUserId" tabindex="1" trim v-model="model.register.userid" :state="state.reg.userid"
                required placeholder="请使用正确的邮箱地址"></b-form-input>
            </b-input-group>
            <b-input-group prepend="您的全称" class="mb-1">
              <b-form-input id="regUserName" tabindex="2" trim v-model="model.register.name" :state="state.reg.name"
                required placeholder="2个以上汉字或4个以上英文"></b-form-input>
            </b-input-group>
            <b-input-group prepend="您的密码" class="mb-1">
              <b-form-input id="regUserPwd" tabindex="3" trim :type="model.hidepassword?'password':'text'"
                v-model="model.register.pwd" :state="state.reg.pwd" class="no-right-border" required
                placeholder="8个以上字母数字特殊字符">
              </b-form-input>
              <span class="right-round-span">
                <b-button href="#" tabindex="-1" class="show-password" @click="toggleHidePassword"
                  variant="outline-none">
                  <b-icon scale="1.5" :icon="model.hidepassword?'eye':'eye-slash'" />
                </b-button>
              </span>
            </b-input-group>
            <b-input-group prepend="再次录入" class="mb-1">
              <b-form-input id="regUserPwd2" tabindex="4" trim :type="model.hidepassword?'password':'text'"
                v-model="model.register.pwd2" :state="state.reg.pwd2" class="no-right-border" required
                placeholder="两次密码输入需要一致"></b-form-input>
              <span class="right-round-span">
                <b-button href="#" tabindex="-1" class="show-password" @click="toggleHidePassword"
                  variant="outline-none">
                  <b-icon scale="1.5" :icon="model.hidepassword?'eye':'eye-slash'" />
                </b-button>
              </span>
            </b-input-group>
            <div class="bg-none">
            </div>
            <b-row>
              <b-col class="bg-none">
                <b-button @click="ACM.registerUser" tabindex="5" variant="primary">注册 &gt;&gt;</b-button>
              </b-col>
            </b-row>
          </div>
          <div v-show="model.register.step==='code'">
            <b-row>
              <b-col class="pb-4" style="font-size:28px">
                新用户注册
              </b-col>
            </b-row>
            <b-form-group>
              <b-form-input id="regUserCode" tabindex="10" trim v-model="model.register.code"
                class="mb-2 mr-sm-2 mb-sm-0" required placeholder="请输入六位验证码"></b-form-input>
            </b-form-group>
            <b-row>
              <b-col class="bg-none">
                <b-button @click="ACM.verifyRegCode" tabindex="11" variant="primary">验证 &gt;&gt;</b-button>
              </b-col>
            </b-row>
            <b-row>
              <b-col class="bg-none">
                <a href="#" class="card-link" @click="ACM.resendVerifyCode">没有收到验证码？点这里重新发送</a>
              </b-col>
            </b-row>
          </div>
          <div v-if="KFK.urlMode==='ivtcode'" class="mt-3">
            {{model.invitor.name}} 邀请您使用在线协同白板
          </div>
        </b-form>
    </div> <!-- register form-->
    <div id="signinform" class="signinform" v-show="show.section.signin" style="display:none;">
        <b-form v-if="model.signInButWaitVerify===false" autocomplete="off" class="w-100 px-2 text-center">
          <b-row>
            <b-col class="pb-4" style="font-size:28px">
              请登录
            </b-col>
          </b-row>
          <b-input-group prepend="账号" class="mb-1">
            <b-form-input tabindex="1" id="userId" trim v-model="model.signin.userid" placeholder="你的用户名">
            </b-form-input>
          </b-input-group>
          <b-input-group prepend="密码" class="mb-1">
            <b-form-input tabindex="2" id="userPwd" trim :type="model.hidepassword?'password':'text'"
              v-model="model.signin.pwd" class="no-right-border" placeholder="你的密码"></b-form-input>
            <span class="right-round-span">
              <b-button href="#" tabindex="-1" class="show-password" @click="toggleHidePassword" variant="outline-none">
                <b-icon scale="1.5" :icon="model.hidepassword?'eye':'eye-slash'" />
              </b-button>
            </span>
          </b-input-group>
          <div class="bg-none">
            <b-button tabindex="3" @click="ACM.signin" variant="primary">登录 &gt;&gt;</b-button>
          </div>
        </b-form>
        <b-form v-else autocomplete="off" class="w-100 px-2 text-center">
          <b-row>
            <b-col class="pb-4" style="font-size:28px">
              你的邮箱地址尚未验证
            </b-col>
          </b-row>
          <b-form-group>
            <b-form-input id="regUserCode" trim v-model="model.register.code" class="mb-2 mr-sm-2 mb-sm-0" required
              placeholder="请输入六位验证码"></b-form-input>
          </b-form-group>
          <b-row>
            <b-col class="bg-none">
              <b-button @click="ACM.verifyRegCode" variant="primary">现在验证 &gt;&gt;</b-button>
            </b-col>
            <div class="w-100"></div>
            <b-col class="bg-none mt-3">
              <a href="#" class="card-link" @click="ACM.resendVerifyCode">没有收到验证码？点这里重新发送</a>
            </b-col>
            <div class="w-100"></div>
            <b-col class="bg-none  mt-3">
              <a href="#" class="card-link" @click="KFK.checkSession">先不验证，直接使用</a>
            </b-col>
          </b-row>
        </b-form>
    </div><!-- signin form-->
    <div v-show="show.section.designer" style="display:none;">
      <div id="S1">
        <div id="C1">
          <div id="containerbkg" class="grid1"></div>
          <div id="C3">
          </div>
          <div id="selectingrect" class="selectingrect"></div>
          <div id="modeIndicator" style="position:absolute; top: 0px; left: 0px; display: none; ">
            <img id="modeIndicatorImg" src="../assets/pointer.svg" style='width: 18px; height: 18px;' />
            <div id="modeIndicatorDiv" style='width: 18px; height: 18px;'></div>
          </div>
          <img id="linetransformer" src="../assets/linetransformer.svg">
        </div>
      </div>
      <div id="toplogo" class="padlayout">
        <img src="../assets/cocopad.svg" class="logo d-inline-block align-top" alt="COLOBODO">
      </div>

      <div id="left" class="bg-white padlayout">
        <b-list-group>
          <b-list-group-item href="#" class="d-flex align-items-center" @click="setMode('pointer');"
            :active="toolActiveState['pointer']">
            <b-img :src="images['pointer'].src" fluid alt="" scale="2" class="cocotool"></b-img>
          </b-list-group-item>
          <b-list-group-item href="#" class="d-flex align-items-center" @click="setMode('text');"
            :active="toolActiveState['text']">
            <b-img :src="images['text'].src" fluid alt="" scale="2" class="cocotool"></b-img>
          </b-list-group-item>
          <b-list-group-item href="#" class="d-flex align-items-center" @click="setMode('textblock');"
            :active="toolActiveState['textblock']">
            <b-img :src="images['textblock'].src" fluid alt="" scale="2" class="cocotool"></b-img>
          </b-list-group-item>
          <b-list-group-item href="#" class="d-flex align-items-center" @click="setMode('yellowtip');"
            :active="toolActiveState['yellowtip']">
            <b-img :src="images['tip'].src" fluid alt="" scale="2" class="cocotool"></b-img>
          </b-list-group-item>
          <b-list-group-item href="#" class="d-flex align-items-center" @click="setMode('line');"
            :active="toolActiveState['line']">
            <b-img :src="images['line'].src" fluid alt="" scale="2" class="cocotool" id='tool_line'></b-img>
          </b-list-group-item>
          <b-list-group-item href="#" class="d-flex align-items-center" @click="setMode('connect');"
            :active="toolActiveState['connect']">
            <b-img :src="images['connect'].src" fluid alt="" scale="2" class="cocotool" id='tool_connect'></b-img>
          </b-list-group-item>
          <b-list-group-item href="#" class="d-flex align-items-center" @click="setMode('lock');"
            :active="toolActiveState['lock']">
            <b-img :src="images['lock'].src" fluid alt="" scale="2" class="cocotool" id='tool_lock'></b-img>
          </b-list-group-item>
          <b-list-group-item class="m-0 p-0">
            <b-icon icon="blank" scale="0.3"></b-icon>
          </b-list-group-item>
          <b-list-group-item href="#"
            v-if="model.docLoaded && (KFK.APP.model.cocodoc.owner === KFK.APP.model.cocouser.userid)"
            class="d-flex align-items-center" @click="KFK.cleanAllNodes();" :active="toolActiveState['clean']">
            <b-img :src="images['eraser'].src" fluid alt="" class="eraser" id='tool_clean'></b-img>
          </b-list-group-item>

        </b-list-group>
      </div>
      <div id="right" class="padlayout noshow">
        <b-tabs v-model="model.rightTabIndex" content-class="mt-1 w-100" justified>
          <b-tab title="样式" class='cocoproperty'>
            <b-container v-show="show.customfont" class='border-top'>
              <b-button v-b-toggle.collapse-customfont class="mb-1 p-1 w-100" variant='outline-primary'>字体式样</b-button>
              <b-collapse visible id="collapse-customfont">
                <div class="row mx-auto my-1">
                  <div class="col">文本字体</div>
                  <div class="col coco"><input class="fonts p-0" /></div>
                </div>
                <div class="row mx-auto my-1">
                  <div class="col">字体大小</div>
                  <div class="col coco">
                    <input class='selector' size=3 id="spinner_font_size" name="value_font_size" />
                  </div>
                </div>
                <div class="row mx-auto my-1">
                  <div class="col">文本颜色</div>
                  <div class="col coco">
                    <input name="fontColor" id="fontColor" />
                  </div>
                </div>
                <div class="row mx-auto my-1">
                  <div class="col">横向对齐</div>
                  <div class="col coco">
                    <b-form-select id="textAlign" v-model="model.textAlign" :options="model.textAlignOptions"
                      @change="textAlignChanged">
                    </b-form-select>
                  </div>
                </div>
                <div class="row mx-auto my-1">
                  <div class="col">纵向对齐</div>
                  <div class="col coco">
                    <b-form-select id="vertAlign" v-model="model.vertAlign" :options="model.vertAlignOptions"
                      @change="vertAlignChanged">
                    </b-form-select>
                  </div>
                </div>
              </b-collapse>
            </b-container>
            <b-container v-show="show.customshape">
              <b-button v-b-toggle.collapse-customshape class="mb-1 p-1 w-100" variant='outline-primary'>基本式样</b-button>
              <b-collapse visible id="collapse-customshape">
                <b-row class="m-0 pb-1 text-center">
                  <b-col>
                    <b-button v-on:click="KFK.changeBorderRadius(0)" size="sm" class="m=0 p=0" style="padding:0px;"
                      variant='primary'>直角</b-button>
                  </b-col>
                  <b-col>
                    <b-button v-on:click="KFK.changeBorderRadius(20)" size="sm" class="m-0 p-0" pill variant="primary">
                      圆角
                    </b-button>
                  </b-col>
                  <b-col>
                    <b-button v-on:click="KFK.changeToTransparent" size="sm" class="m-0 p-0" variant="outline-primary">
                      透底
                    </b-button>
                  </b-col>
                </b-row>
                <b-row class="mx-auto my-1">
                  <b-col>背景底色</b-col>
                  <b-col class='coco'><input class="w-100" name="shapeBkgColor" id="shapeBkgColor" /></b-col>
                </b-row>
                <b-row class="mx-auto my-1">
                  <b-col>边框颜色</b-col>
                  <b-col class='coco'><input name="shapeBorderColor" id="shapeBorderColor" /></b-col>
                </b-row>
                <b-row class="mx-auto my-1">
                  <b-col>边框粗细</b-col>
                  <b-col class='coco'><input class='selector' size=3 id="spinner_border_width" name="value_bw" />
                  </b-col>
                </b-row>
                <b-row class="mx-auto my-1">
                  <b-col>圆角度数</b-col>
                  <b-col class='coco'><input class='selector' size=3 id="spinner_border_radius" name="value_rad" />
                  </b-col>
                </b-row>
              </b-collapse>
            </b-container>
            <b-container v-show="show.customline">

              <b-button v-b-toggle.collapse-customline class="mb-1 p-1 w-100" variant='outline-primary'>线条式样</b-button>
              <b-collapse visible id="collapse-customline">
                <b-row class="mx-auto my-1">
                  <b-col>线条颜色</b-col>
                  <b-col class='coco'><input name="lineColor" id="lineColor" /></b-col>
                </b-row>
                <b-row class="mx-auto my-1">
                  <b-col>线条粗细</b-col>
                  <b-col class='coco'><input class='selector' size=3 id="spinner_line_width" name="value_lw" /></b-col>
                </b-row>
                <b-row class="mx-auto my-1">

                  <b-checkbox id="cb-linecap" v-model="model.line.linecap" name="cb-linecap" switch
                    @change="KFK.lineCapChanged">
                    圆头线条
                  </b-checkbox>
                </b-row>
              </b-collapse>
            </b-container>
            <b-container v-show="show.custombacksvg">
              <b-row class="mx-auto my-1">
                <b-col>贴纸颜色</b-col>
                <b-col class='coco'><input name="tipBkgColor" id="tipBkgColor" /></b-col>
              </b-row>
              <b-button v-b-toggle.collapse-toolgroup2 class="mb-1 p-1 w-100" variant='outline-primary'>基本形状</b-button>
              <b-collapse visible id="collapse-toolgroup2">

                <b-container id="toolbox2" class="w-100" style="height: 300px; width:100%; overflow-y:scroll; ">
                </b-container>
              </b-collapse>
              <b-button v-b-toggle.collapse-toolgroup3 class="mb-1 p-1 w-100" variant='outline-primary'>商务组件</b-button>
              <b-collapse visible id="collapse-toolgroup3">
                <b-container id="toolbox3" class="w-100" style="height: 300px; width:100%; overflow-y:scroll; ">
                </b-container>
              </b-collapse>
            </b-container>
          </b-tab>
          <b-tab title="排列" class="cocoproperty">
            <b-button-toolbar v-show="show.layercontrol" key-nav class="w-100 justify-content-md-center">
              <p>图层设置</p>
              <b-button-group class="d-flex w-100" title="hello">
                <b-button variant="light" title="到最上(T)" class="flex-fill p-0" @click="KFK.ZiToTop()">
                  <b-icon icon="chevron-double-up" />
                </b-button>
                <b-button variant="light" title="上一层(H)" class="flex-fill p-0" @click="KFK.ZiToHigher()">
                  <b-icon icon="chevron-up" />
                </b-button>
                <b-button variant="light" title="下一层(G)" class="flex-fill p-0" @click="KFK.ZiToLower()">
                  <b-icon icon="chevron-down" />
                </b-button>
                <b-button variant="light" title="到最下(B)" class="flex-fill p-0" @click="KFK.ZiToBottom()">
                  <b-icon icon="chevron-double-down" />
                </b-button>
              </b-button-group>
            </b-button-toolbar>
            <b-button-toolbar v-show="show.arrange_multi_nodes" key-nav class="w-100 justify-content-md-center">
              <p>对齐设置</p>
              <b-button-group class="d-flex w-100">
                <b-button variant="light" title="对齐左侧" class="flex-fill p-0" @click="KfkAlign('left')"><img
                    src="../assets/align_left.svg" class="toolbar"></b-button>
                <b-button variant="light" title="对齐垂直中线" class="flex-fill p-0" @click="KfkAlign('center')"><img
                    src="../assets/align_center.svg" class="toolbar"></b-button>
                <b-button variant="light" title="对齐右侧" class="flex-fill p-0" @click="KfkAlign('right')"><img
                    src="../assets/align_right.svg" class="toolbar"></b-button>
                <b-button variant="light" title="对齐顶部" class="flex-fill p-0" @click="KfkAlign('top')"><img
                    src="../assets/align_top.svg" class="toolbar"></b-button>
                <b-button variant="light" title="对齐水平中线" class="flex-fill p-0" @click="KfkAlign('middle')"><img
                    src="../assets/align_middle.svg" class="toolbar"></b-button>
                <b-button variant="light" title="对齐底部" class="flex-fill p-0" @click="KfkAlign('bottom')"><img
                    src="../assets/align_bottom.svg" class="toolbar"></b-button>
              </b-button-group>
            </b-button-toolbar>
            <b-button-toolbar v-show="show.arrange_multi_nodes" key-nav class="w-100 justify-content-md-center">
              <b-button-group class="d-flex w-100">
                <b-button variant="light" class="flex-fill" title="横向均匀分布" @click="KfkAlign('hori')"><img
                    src="../assets/align_hori.svg" class="toolbar"></b-button>
                <b-button variant="light" class="flex-fill" title="纵向均匀分布" @click="KfkAlign('vert')"><img
                    src="../assets/align_vert.svg" class="toolbar"></b-button>
              </b-button-group>
            </b-button-toolbar>
          </b-tab>
          <b-tab title="COCO" active class='cocoproperty'>
            <p>欢迎使用</p>
            <b-checkbox id="cb-showgrid" v-model="model.cococonfig.showgrid" name="cb-showgrid" switch
              @change="KFK.showGridChanged">
              显示网格线
            </b-checkbox>
            <b-checkbox id="cb-showbounding" v-model="model.cococonfig.showbounding" name="cb-showbounding" switch
              @change="KFK.showBoundingChanged">
              显示分页线
            </b-checkbox>
            <b-checkbox v-model="model.cococonfig.snap" switch @change="KFK.snapChanged">
              对齐到网格
            </b-checkbox>
            <b-checkbox v-model="model.cococonfig.showlock" switch @change="KFK.toggleShowLock">
              显示锁定标志
            </b-checkbox>
            <p> </p>
            <b-container class="coco">
              <b-row class="mx-auto my-1">
                <b-col>背景颜色</b-col>
                <b-col class="coco">
                  <b-form-input v-model="model.cococonfig.bgcolor" name="cocoBkgColor" id="cocoBkgColor" />
                </b-col>
              </b-row>
            </b-container>
            <b-container class="coco">
              <b-row class="mx-auto my-1">
                <b-col>显示编辑者</b-col>
              </b-row>
              <b-row class="mx-auto my-1">
                <b-form-radio v-model="model.showEditor" name="some-radios" value="none"
                  @change="showEditorChanged('none')">隐藏</b-form-radio>
                <b-form-radio v-model="model.showEditor" name="some-radios" value="last"
                  @change="showEditorChanged('last')">最近</b-form-radio>
                <b-form-radio v-model="model.showEditor" name="some-radios" value="all"
                  @change="showEditorChanged('all')">全部</b-form-radio>
              </b-row>
            </b-container>
          </b-tab>
          </b-tab>
        </b-tabs>
      </div>

      <div id="rtcontrol" class="padlayout noshow">
        <b-button-group class="coco">
          <b-button id="goto_explorer" variant="outline-success" @click="KFK.gotoExplorer">
            <b-icon icon="house"></b-icon>
          </b-button>
          <b-button id='sharethisbutton' @click="SHARE.shareThisDoc" class="" variant="outline-success">
            <b-icon icon="box-arrow-up"></b-icon>分享
          </b-button>
        </b-button-group>
        <b-button-group class="coco">
          <b-button id="onepage" variant="outline-success" @click="KFK.toggleOnePage">
            <b-icon icon="grid3x2" shift-h="-1.2" shift-v="1.1"></b-icon>
          </b-button>
        </b-button-group>
        <b-button-group class="coco">
          <b-button disable="model.cocodoc.readonly" id="toggle_all" variant="outline-success"
            @click="KFK.toggleFullScreen">
            <b-icon icon="arrows-fullscreen"></b-icon>
          </b-button>
          <b-button disable="model.cocodoc.readonly" id="toggle_cbonly" variant="outline-success"
            @click="KFK.toggleControlButtonOnly">
            <b-icon v-if="KFK.controlButtonsOnly===false" icon="layout-sidebar-reverse" rotate="270"></b-icon>
            <b-icon v-else icon="layout-sidebar-inset-reverse" rotate="270"></b-icon>
          </b-button>
          <b-button disable="model.cocodoc.readonly" id="toggle-right" variant="outline-success"
            @click="KFK.toggleRight">
            <b-icon v-if="KFK.showRightTools===false" icon="layout-sidebar-reverse"></b-icon>
            <b-icon v-else icon="layout-sidebar-inset-reverse"></b-icon>
          </b-button>
          <b-button disable="model.cocodoc.readonly" id="toggle-minimap" variant="outline-success"
            @click="KFK.toggleMinimap">
            <b-icon icon="map"></b-icon>
          </b-button>
        </b-button-group>
      </div>
      <div id="actionloglist" v-show="show.actionlog" style="overflow-y:scroll" class="p-3">
        协作参与者
        <div id='actionlog-refresh'>
          <b-button @click="KFK.getActionLog" variant="link" class="m-0 p-0">刷新</b-button>
        </div>
        <div id='actionlog-close'>
          <b-button @click="KFK.showActionLog" variant="link" class="m-0 p-0">关闭</b-button>
        </div>
        <b-list-group>
          <b-list-group-item v-for="(actionlog,index) in model.actionlog" v-bind:index="index" v-bind:key="'hl'+index"
            class="d-flex flex-nowrap text-nowrap">
            <b-container class="m-0 p-0">
              <b-row class="pb-1">
                <b-col cols="10" style="width:100px; white-space:nowrap; overflow-x:scroll; overflow-y:hidden;">
                  <img :src="actionlog.avatarSrc" class="avatar-in-line" />
                  {{actionlog.name}}</b-col>
                <b-col cols="2">
                  <b-badge variant="primary" pill>{{actionlog.logs.length}}</b-badge>
                </b-col>
              </b-row>
              <b-row>
                <b-button-group size="sm" class="w-100">
                  <b-button size="sm" @click="KFK.navActionLog(actionlog,  'first')" variant="outline-primary">
                    <b-icon icon="skip-start-fill" variant="primary"> </b-icon>
                  </b-button>
                  <b-button size="sm" @click="KFK.navActionLog(actionlog,  'prev')" variant="outline-primary">
                    <b-icon icon="caret-left-fill" variant="primary"> </b-icon>
                  </b-button>
                  <b-button size="sm" @click="KFK.navActionLog(actionlog,  'next')" variant="outline-primary">
                    <b-icon icon="caret-right-fill" variant="primary"></b-icon>
                  </b-button>
                  <b-button size="sm" @click="KFK.navActionLog(actionlog,  'last')" variant="outline-primary">
                    <b-icon icon="skip-end-fill" variant="primary"> </b-icon>
                  </b-button>
                </b-button-group>
              </b-row>
            </b-container>
          </b-list-group-item>
        </b-list-group>
      </div>
      <div class="padlayout docHeaderInfo">
        <div class="docname" v-if="show.section.designer">
          <b-icon v-if="model.cocodoc.readonly" icon="lock" variant="secondary"></b-icon>
          <b-icon v-else icon="book" variant="secondary"></b-icon>
          {{model.cocodoc.name}}
        </div>
        <div class="docpeople padlayout" v-if="show.section.designer">
          <div>
            <b-img v-if="model.cocodoc.owner !== model.cocouser.userid" rounded="circle"
              :src="model.cocodoc.ownerAvatar_src" title="共创发起人"></b-img>
            <span v-if="model.cocodoc.owner !== model.cocouser.userid">发起人:{{model.cocodoc.ownerName}}</span>
            <b-img rounded="circle" v-if="model.cocouser.avatar_src" :src="model.cocouser.avatar_src" title="当前用户">
            </b-img>
            <b-dropdown :text="model.cocouser.name" right size="sm" variant="link" class="m-0 p-0 userinfo">
              <b-dropdown-item-button>{{model.cocouser.name}}</b-dropdown-item-button>
              <b-dropdown-item-button v-if="!model.isDemoEnv" @click="KFK.showIvtCodeDialog">邀请获奖励
              </b-dropdown-item-button>
              <b-dropdown-item-button v-if="!model.isDemoEnv" @click="KFK.showSetProfileDialog()">修改账户信息
              </b-dropdown-item-button>
              <b-dropdown-divider></b-dropdown-divider>
              <b-dropdown-item-button @click="KFK.gotoPrjList">我的项目</b-dropdown-item-button>
              <b-dropdown-item-button @click="KFK.gotoExplorer">我的白板</b-dropdown-item-button>
              <b-dropdown-divider></b-dropdown-divider>
              <b-dropdown-item-button v-if="model.isDemoEnv" @click="KFK.upgradeToStartAccount">注册为正式用户
              </b-dropdown-item-button>
              <b-dropdown-item-button v-else @click="KFK.signout">退出登录状态</b-dropdown-item-button>
              <b-dropdown-item-button v-if="model.isDemoEnv" @click="KFK.gotoSignin">登录已有账号
              </b-dropdown-item-button>
            </b-dropdown>
            <b-button title='hello' class="m-0 p-0" variant='link' @click="KFK.showActionLog">
              <b-icon icon="people"></b-icon>
            </b-button>{{model.actionlog.length}}
          </div>
        </div>
      </div>
    <div id="readonlyDesc" v-show="show.section.designer" class="padlayout">
      {{model.readonlyDesc}}
    </div>
    <div id="minimap" v-show="show.section.designer && show.section.minimap" class="padlayout">
    </div>
    </div><!-- designer-->
    <div class="explorer" v-show="show.section.explorer" style="display:none;">
      <div class="inner" @click="KFK.hideDocOpMenu();">
        <b-navbar class='explorer-navbar' type="light" variant="light">
          <b-navbar-nav class="mr-auto">
            <b-navbar-brand href="#">
            </b-navbar-brand>
          </b-navbar-nav>
          <b-navbar-nav class="mr-auto myhovered">
            <b-nav-item v-if="model.prjs.length<1" @click="KFK.showCreateNewPrj">你还没有项目，现在新建一个 </b-nav-item>
            <b-nav-item v-else @click="KFK.showCreateNewPrj"> 新建项目 </b-nav-item>
          </b-navbar-nav>
          <b-navbar-nav class="mr-auto myhovered">
            <b-nav-item @click="KFK.showCreateNewDoc">发起新协作</b-nav-item>
          </b-navbar-nav>
          <b-navbar-nav class="mr-auto">
            <b-navbar-brand href="#">
            </b-navbar-brand>
          </b-navbar-nav>

        </b-navbar>
        <div class="explorer-user-info">
          <b-row>
            <b-col cols="12">
              <div v-show="model.cocouser.avatar_src">
                <img :src="model.cocouser.avatar_src" class="explorer-user-avatar"></img>
              </div>
              <div class="explorer-user-dropdown">
                <b-dropdown variant="outline-none" class="m-0 p-0" :text="model.cocouser.name">
                  <b-dropdown-item-button v-if="!model.isDemoEnv" @click="KFK.showSetProfileDialog()">修改账户信息
                  </b-dropdown-item-button>
                  <b-dropdown-divider></b-dropdown-divider>
                  <b-dropdown-item-button @click="KFK.gotoPrjList">我的项目</b-dropdown-item-button>
                  <b-dropdown-item-button @click="KFK.gotoDocs">我的白板</b-dropdown-item-button>
                  <b-dropdown-divider></b-dropdown-divider>
                  <b-dropdown-item-button v-if="model.isDemoEnv" @click="KFK.upgradeToStartAccount">注册为正式用户
                  </b-dropdown-item-button>
                  <b-dropdown-item-button v-else @click="KFK.signout">退出登录状态</b-dropdown-item-button>
                  <b-dropdown-item-button v-if="model.isDemoEnv" @click="KFK.gotoSignin">登录已有账号
                </b-dropdown>
              </div>
            </b-col>
          </b-row>
        </div>
        <div class="explorer-content"
          v-show="show.form.newdoc || show.form.newprj || show.form.doclist || show.form.prjlist">
          <b-tabs card id="tabs-main" v-model="show.form.explorerTabIndex" vertical
            active-nav-item-class="font-weight-bold text-uppercase text-danger" active-tab-class="">
         
            <b-tab title="我的项目" @click="KFK.gotoPrjList">
              <div v-show="show.form.newprj">
                <b-card title="新建项目">
                  <b-form>

                    <b-input-group prepend="项目名称" class="pt-4 px-5">
                      <b-form-input id="prjName" trim v-model="model.newprjname" :state="state.newprj.name"
                        placeholder=""></b-form-input>
                      <b-form-invalid-feedback id="prjName-feedback">
                        名称为3个以上英文或中文字符，不超过20个
                      </b-form-invalid-feedback>
                    </b-input-group>
                    <b-input-group class="pt-2 px-5 d-flex justify-content-start">
                      <b-button variant="primary" @click="KFK.createNewPrj">新建 &gt;&gt;</b-button>
                    </b-input-group>

                  </b-form>
                  <div>&nbsp;</div>
                  <div>&nbsp;</div>
                  <a href="#" class="card-link" @click="KFK.gotoPrjList">&lt; 返回项目列表</a>
                </b-card>
              </div>
              <div v-show="show.form.prjlist">
                <div class='page_title'>{{model.prjwarning}}</div>
                <!-- prj list -->
                <b-table hover id="my-prj-table" :items="model.prjs" :per-page="model.perPage"
                  :current-page="model.currentPrjPage" small :fields="model.prjfields"
                  @row-clicked="KFK.prjRowClickHandler">
                  <template v-slot:cell(operations)="data">
                    <b-button size="sm" @click="deletePrjItem(data.item, data.index, $event.target)"
                      class="m-0 p-0 myhovered" variant="outline-none">
                      <b-iconstack>
                        <b-icon stacked icon="x"></b-icon>
                        <b-icon stacked icon="folder"></b-icon>
                      </b-iconstack> 删除项目
                    </b-button>
                  </template>
                  <template v-slot:cell()="data">
                    {{ data.value }}
                  </template>
                </b-table>
                <div>
                  <b-pagination class="justify-content-center" v-model="model.currentPrjPage" :total-rows="prjcount"
                    :per-page="model.perPage" aria-controls="my-prj-table" first-text="第一页" prev-text="上一页"
                    next-text="下一页" last-text="最后页" pills></b-pagination>
                </div>
              </div>
            </b-tab>
            <b-tab title="我的白板" @click="KFK.gotoDocs">
              <div v-show="show.form.newdoc">
                <!-- FORM new doc new board create new-->
                <b-card title="新建白板, 发起协作">
                  <b-card-text>
                    在项目 <span class="cocohighlight-2">{{model.lastrealproject.name}}</span> 中发起
                    <a href="#" class="card-link" @click="KFK.pickPrjForCreateDoc">选择其他项目 &gt;</a>
                  </b-card-text>
                  <b-form>


                    <b-input-group prepend="白板名称" class="pt-4 px-5">
                      <b-form-input id="docName" trim v-model="model.newdocname" :state="state.newdoc.name"
                        placeholder=""></b-form-input>
                      <b-form-invalid-feedback id="prjName-feedback">
                        名称为3个以上英文或中文字符，不超过20个
                      </b-form-invalid-feedback>
                    </b-input-group>
                    <b-input-group prepend="访问密码" class="pt-2 px-5">
                      <b-form-input id="docPwd" :type="model.hidepassword?'password':'text'" trim
                        v-model="model.newdocpwd" placeholder=""></b-form-input>
                      <b-input-group-append>
                        <b-button href="#" tabindex="-1" class="show-password" @click="toggleHidePassword">
                          <b-icon :icon="model.hidepassword?'eye':'eye-slash'" size="sm"></b-icon>
                        </b-button>
                      </b-input-group-append>
                    </b-input-group>
                    <b-input-group class="pt-2 px-5 d-flex justify-content-start">
                      <b-button variant="primary" @click="KFK.createNewDoc">发起 &gt;&gt;</b-button>
                    </b-input-group>
                  </b-form>
                  <div>&nbsp;</div>
                  <div>&nbsp;</div>
                  <a href="#" class="card-link" @click="KFK.gotoDocs">&lt; 返回文档列表</a>
                </b-card>
              </div>
              <div v-show="show.form.doclist" style="overflow-y:scroll">
                <b-row class="docnav w-75 text-center p-2">
                  <b-col class="myhovered" @click="KFK.gotoPrj('mine')">
                    我发起的
                  </b-col>
                  <b-col class="myhovered" @click="KFK.gotoPrj('others')">
                    他人分享的
                  </b-col>
                  <b-col class="myhovered" @click="KFK.gotoPrj('all')">
                    最近访问的
                  </b-col>
                  <b-col v-if="model.lastrealproject.prjid!==''" class="myhovered"
                    @click="KFK.gotoLastRealProject('all')">
                    最近项目的
                  </b-col>
                </b-row>
                <div class="page_title" v-if="['all','others','mine'].indexOf(model.cocoprj.prjid)>=0">
                  {{model.cocoprj.name}}
                </div>
                <div v-else class="page_title"><span class="cocohighlight-2">{{model.cocoprj.name}}</span> 中的共创白板 </div>
                <!-- doc list -->
                <b-table hover id="my-doc-table" :items="model.docs" :per-page="model.perPage"
                  :current-page="model.currentDocPage" small :fields="model.docfields"
                  @row-clicked="KFK.docRowClickHandler">

                  <template v-slot:head(name)="data">
                    <b-button variant="outline-none">{{ data.label }}</b-button>
                  </template>
                  <template v-slot:head(acl)="data">
                    <b-button variant="outline-none" v-b-popover.hover.topright title="设置访问范围">
                      {{ data.label }}</b-button>
                  </template>
                  <template v-slot:head(readonly_icon)="data">
                    <b-button variant="outline-none" v-b-popover.hover.topright title="在只读模式和可编辑模式之间切换">
                      {{ data.label }}</b-button>
                  </template>
                  <template v-slot:head(protect_icon)="data">
                    <b-button variant="outline-none" v-b-popover.hover.topright title="设置协作保护密码">
                      {{ data.label }}</b-button>
                  </template>
                  <template v-slot:head(docduplicate)="data">
                    <b-button variant="outline-none" v-b-popover.hover.topright title="复制/改名/移动">
                      {{ data.label }}</b-button>
                  </template>
                  <template v-slot:head(share_icon)="data">
                    <b-button variant="outline-none" v-b-popover.hover.topright title="获得分享链接地址">
                      {{ data.label }}</b-button>
                  </template>
                  <template v-slot:head(owner)="data">
                    <b-button variant="outline-none" v-b-popover.hover.topright title="白板发起人">
                      {{ data.label }}</b-button>
                  </template>
                  <template v-slot:head(operations)="data">
                    <b-button variant="outline-none" v-b-popover.hover.topright title="其它相关操作">
                      {{ data.label }}</b-button>
                  </template>

                  <template v-slot:cell(docduplicate)="data">
                    <b-col class="d-flex align-items-center">
                      <b-button size="sm" class="m-0 p-0" variant="outline-none"
                        @click="KFK.showCopyDocDialog(data.item, data.index, $event.target)">
                        <b-icon icon="files" variant="secondary">
                      </b-button>
                    </b-col>
                  </template>
                  <template v-slot:cell(protect_icon)="data">
                    <b-col class="d-flex align-items-center">
                      <b-button v-if="KFK.iAmOwner(data.item)" size="sm" class="m-0 p-0 myhovered"
                        variant="outline-none" @click="KFK.showResetPwdModal(data.item, data.index, $event.target)">
                        <b-icon :icon="data.item.protect_icon" class="opicon"> </b-icon>
                      </b-button>
                      <b-icon v-else :icon="data.item.protect_icon"> </b-icon>
                    </b-col>
                  </template>
                  <template v-slot:cell(readonly_icon)="data">
                    <b-col class="d-flex align-items-center">
                      <b-button v-if="KFK.iAmOwner(data.item)" size="sm" class="m-0 p-0 myhovered"
                        variant="outline-none" @click="KFK.setDocReadonly(data.item, data.index, $event.target)">
                        <b-icon :icon="data.item.readonly_icon" variant="secondary" class="opicon"></b-icon>
                      </b-button>
                      <b-icon v-else :icon="data.item.readonly_icon" variant="secondary"></b-icon>
                    </b-col>
                  </template>
                  <template v-slot:cell(share_icon)="data">
                    <b-col class="d-flex align-items-center">
                      <b-button size="sm" class="m-0 p-0 text-center" variant="outline-none"
                        @click="SHARE.shareDoc(data.item, data.index, $event.target)">
                        <b-icon icon="box-arrow-up" variant="secondary"></b-icon>
                      </b-button>
                    </b-col>
                  </template>
                  <template v-slot:cell(operations)="data">
                    <b-col class="d-flex align-items-right" style="padding:0px;">
                      <b-button size="sm" class="m-0 p-0" variant="info"
                        v-on:click="KFK.showDocOpMenu(data.item, data.index, $event)">
                        操作
                      </b-button>
                    </b-col>
                  </template>
                  <template v-slot:cell(owner)="data">
                    <b-col class="d-flex align-items-center doc-owner-width">
                      <div v-if="data.item.ownerAvatar">
                        <img :src="data.item.ownerAvatarSrc" style="width:18px; height:18px;"></img>
                        {{data.item.ownerName}}
                      </div>
                      <div v-else class="roundInitial">
                        {{data.item.ownerName}}
                      </div>
                    </b-col>
                  </template>
                  <template v-slot:cell(name)="data">
                    <b-col class="d-flex align-items-center doc-name-width">
                      <div class="doc-name-inner">
                        {{data.item.name}}
                      </div>
                    </b-col>
                  </template>
                  <template v-slot:cell(acl)="data">
                    <b-col :id="'orgName-'+data.index"
                      :class="'d-flex align-items-center doc-acl-width doc-acl-' + data.item.acl">
                      {{data.item.acl_desc}}
                      <b-tooltip :target="'orgName-'+data.index" variant="primary"
                        :title="KFK.getAclOwnerDescription(data.item)">
                      </b-tooltip>
                    </b-col>
                  </template>
                  <template v-slot:cell()="data">
                    <b-col class="d-flex align-items-center">
                      {{ data.value }}
                    </b-col>
                  </template>
                </b-table>
                <div>
                  <b-pagination class="justify-content-center" v-model="model.currentDocPage" :total-rows="doccount"
                    :per-page="model.perPage" aria-controls="my-doc-table" first-text="第一页" prev-text="上一页"
                    next-text="下一页" last-text="最后页" pills></b-pagination>
                </div>

              </div>
            </b-tab>
            <b-tab title="我的组织" @click="KFK.onClickOrgTab">
              <!-- org list -->
              <!-- https://bootstrap-vue.js.org/docs/components/collapse/#accordion-support -->
              <div role="tablist">
                <b-card no-body class="mb-1">
                  <b-card-header header-tag="header" class="p-1" role="tab">
                    <b-button block href="#" v-b-toggle.accordion_currentorg variant="info">当前组织:
                      {{model.cocouser.orgname}}
                    </b-button>
                  </b-card-header>
                  <b-collapse id="accordion_currentorg" visible accordion="my-accordion" role="tabpanel">
                    <b-card-body>
                      您当前工作所在的组织为: {{model.cocouser.orgname}}
                    </b-card-body>
                  </b-collapse>
                </b-card>
                <b-card no-body class="mb-1">
                  <!-- my org myorg my orgs myorgs -->
                  <b-card-header header-tag="header" class="p-1" role="tab">
                    <b-button block href="#" v-b-toggle.accordion_myorg variant="info"
                      @click="KFK.toggleAccordionMyOrg">
                      我创建并管理的组织
                    </b-button>
                  </b-card-header>
                  <b-collapse id="accordion_myorg" v-model="model.accordion.myorg" accordion="my-accordion"
                    role="tabpanel">
                    <b-card-body>
                      <b-table hover id="my-myorg-table" :items="model.myorgs" small :fields="model.myorgfields">
                        <template v-slot:cell(operations)="row">
                          <b-button size="sm" @click="KFK.toggleDetails(row)" class="mr-2">
                            {{ row.detailsShowing ? '隐藏' : '查看'}} 详情
                          </b-button>
                          <b-button size="sm" @click="KFK.deleteOrg(row.item._id, row.item.name)" class="mr-2">
                            删除组织
                          </b-button>
                          <b-button size="sm" @click="KFK.enterOrg(row.item._id)" class="mr-2">
                            切换到
                          </b-button>
                        </template>
                        <template v-slot:row-details="row">
                          <b-form inline>
                            <label class="sr-only" for="inline-form-input-newuserid">userId Email</label>
                            <b-input-group prepend="@" class="mb-2 mr-sm-2 mb-sm-0">
                              <b-input :id="'inline-form-input-newuserid-' + row.index" placeholder="userId email">
                              </b-input>
                              <b-button @click="KFK.addOrgUser(row.item._id, row.index)" size="sm" variant="primary">
                                添加成员
                              </b-button>
                            </b-input-group>
                            <!-- add org member add member-->
                            <b-input-group prepend="改名" class="mb-2 mr-sm-2 mb-sm-0">
                              <b-input :id="'inline-form-input-changeorgname-'+ row.index"
                                placeholder="新名字, 4-20个英文字母或汉字"></b-input>
                              <b-button @click="KFK.changeOrgName(row.item._id, row.index)" size="sm" variant="primary">
                                修改名称</b-button>
                            </b-input-group>
                            <!-- add org member add member-->
                          </b-form>
                          <b-table :items="model.orgusers[row.item._id]" small :fields="model.useridfields">
                            <template v-slot:cell(operations)="data">
                              <b-button size="sm" class="m-0 p-0" variant="outline-danger"
                                @click="KFK.deleteOrgUser(row.item._id, data.item, data.index, $event.target)"
                                variant="outline-primary">
                                <b-icon icon="trash"></b-icon>
                              </b-button>
                            </template>
                            <template v-slot:cell()="data">
                              <!-- 每个orguser的缺省显示-->
                              {{ data.value }}
                            </template>
                          </b-table>
                        </template>
                        <template v-slot:cell()="data">
                          <!-- 每个org的缺省显示 -->
                          {{ data.value }}
                        </template>
                      </b-table>
                    </b-card-body>
                  </b-collapse>
                </b-card>
                <b-card no-body class="mb-1">
                  <!-- my vorg myvog my joined org-->
                  <b-card-header header-tag="header" class="p-1" role="tab">
                    <b-button block href="#" v-b-toggle.accordion_vorg variant="info"
                      @click="KFK.toggleAccordionEnteredOrg">我加入的他人管理的组织
                    </b-button>
                  </b-card-header>
                  <b-collapse id="accordion_vorg" accordion="my-accordion" role="tabpanel">
                    <b-card-body>
                      <b-table hover id="my-vorg-table" :items="model.vorgs" small :fields="model.vorgfields">
                        <template v-slot:cell(operations)="row">
                          <b-button size="sm" @click="KFK.enterOrg(row.item._id)" class="mr-2">
                            切换到
                          </b-button>
                        </template>
                        <template v-slot:cell()="data">
                          {{ data.value }}
                        </template>
                      </b-table>
                    </b-card-body>
                  </b-collapse>
                </b-card>
                <b-card no-body class="mb-1">
                  <b-card-header header-tag="header" class="p-1" role="tab">
                    <b-button block href="#" v-b-toggle.accordion_neworg variant="info">新创建组织</b-button>
                  </b-card-header>
                  <b-collapse id="accordion_neworg" accordion="my-accordion" role="tabpanel">
                    <b-card-body>
                      <b-form>
                        <b-input-group prepend="组织名称">
                          <b-form-input class="coco-input" id="neworgname" trim placeholer="4-20个英文字母或汉字"
                            v-model="model.org.neworg.name">
                          </b-form-input>
                          <b-button @click="KFK.createNewOrg">创建</b-button>
                        </b-input-group>
                      </b-form>
                    </b-card-body>
                  </b-collapse>
                </b-card>
              </div>
            </b-tab>
          </b-tabs>
          <b-row class="text-center" v-if="model.isDemoEnv">
            <b-col class="mt-5 pt-5">
              <a href="#" class="card-link" @click="KFK.upgradeToStartAccount">当前为演示账户，操作不会被保存<BR>
                注册为正式用户，以便享有更多功能</a>
            </b-col>
            <div class="w-100"></div>
            <b-col class="mt-3 pt-3">
              <a href="#" class="card-link" @click="KFK.gotoSignin" style='font-size:18px'>已有账号？请登录</a>
            </b-col>
          </b-row>
          <div class="footnote">
            <b-row v-if="model.cocouser.ivtcode">
              <b-col>
                <b-button class="m-0 p-0" variant='link' @click="KFK.showIvtCodeDialog">邀请同事或好友使用</b-button>
              </b-col>
            </b-row>
            <b-row v-if="model.cocouser.ivtcode">
              <b-col>
                <b-button class="m-0 p-0" variant='link' @click="KFK.showIvtCodeDialog">获奖操作积分</b-button>
              </b-col>
            </b-row>
            <b-row role="link">
              <b-col>
                <b-link :target="'_blank'" class="m-0 p-0" href='http://weibo.com/cocopad'>@COLOBODO 2020</b-link>
              </b-col>
            </b-row>
          </div>
        </div>
        <b-modal @shown="KFK.notImplemented" @ok="KFK.notImplemented" @hide="KFK.notImplemented"
          @close="KFK.notImplemented" @cancel="KFK.notImplemented" v-model="show.dialog.docOpDialog" title="白板设置"
          button-size="sm" centered size="md">
          <b-container>
            <b-input-group prepend="协作码">
              <b-form-input trim :type="model.hidepassword?'password':'text'" v-model="model.opendocpwd"
                ref="focusThis">
              </b-form-input>
              <b-input-group-append>
                <b-button href="#" tabindex="-1" class="show-password" @click="toggleHidePassword">
                  <b-icon scale="1" :icon="model.hidepassword?'eye':'eye-slash'"></b-icon>
                </b-button>
              </b-input-group-append>
            </b-input-group>
          </b-container>
        </b-modal>
        <b-modal @shown="focusOnPwdInput" @ok="KFK.getDocPwd" @hide="KFK.onDocPwdHidden" @close="KFK.cancelDocPwd"
          @cancel="KFK.cancelDocPwd" v-model="show.dialog.inputDocPasswordDialog" title="请输入协作码" button-size="sm"
          centered size="md">
          <b-container>
            <b-input-group prepend="协作码">
              <b-form-input trim :type="model.hidepassword?'password':'text'" v-model="model.opendocpwd"
                ref="focusThis">
              </b-form-input>
              <b-input-group-append>
                <b-button href="#" tabindex="-1" class="show-password" @click="toggleHidePassword">
                  <b-icon scale="1" :icon="model.hidepassword?'eye':'eye-slash'"></b-icon>
                </b-button>
              </b-input-group-append>
            </b-input-group>
          </b-container>
        </b-modal>
        <b-modal @ok="KFK.resetDocPwd" v-model="show.dialog.resetDocPasswordDialog"
          title="设置协作密码" button-size="sm" centered size="md">
          <b-input-group prepend="原协作码" class="px-5 pt-2">
            <b-form-input tabindex="1" trim :type="model.hidepassword?'password':'text'" v-model="model.docOldPwd">
            </b-form-input>
            <span class="right-round-span">
              <b-button href="#" tabindex="-1" class="show-password" @click="toggleHidePassword"
                variant="outline-none">
                <b-icon :icon="model.hidepassword?'eye':'eye-slash'" size="sm"></b-icon>
              </b-button>
            </span>
          </b-input-group>
          <b-input-group prepend="新协作码" class="px-5 pt-2">
            <b-form-input tabindex="2" trim :type="model.hidepassword?'password':'text'" v-model="model.docNewPwd">
            </b-form-input>
            <span class="right-round-span">
              <b-button href="#" tabindex="-1" class="show-password" @click="toggleHidePassword"
                variant="outline-none">
                <b-icon :icon="model.hidepassword?'eye':'eye-slash'" size="sm"></b-icon>
              </b-button>
            </span>
          </b-input-group>
          <div class="px-5 pt-2">
            <a href="#" class="card-link" @click="KFK.toggleFromResetToRemovePwd">&lt; 如忘记原协作码，可输入用户密码予以清除</a>
            <BR>
            <b-button variant="outline-none" v-b-popover.hover.top="model.showHelp?'':'点击查看帮助说明'"
              @click="KFK.toggleShowHelp">
              <b-icon icon="question-square"></b-icon>
            </b-button>
            <div v-if="model.showHelp" class="inner-help">
              <ul>设置协作密码后,只有知道协作密码才能打开白板
                <li>如原先无密码,请保持原协作码为空即可</li>
                <li>如要取消密码,请保持新协作码为空,即可清除密码</li>
              </ul>

            </div>
          </div>
        </b-modal>
        <b-modal @shown="focusOnUserPwdInput" @ok="KFK.removeDocPwd" v-model="show.dialog.userPasswordDialog"
          title="请输入你的用户密码" button-size="sm" centered size="md">
          <b-input-group prepend="用户密码" class="pt-2 px-5">
            <b-form-input trim :type="model.hidepassword?'password':'text'" v-model="model.inputUserPwd"
              ref="focusUserPwd">
            </b-form-input>
            <b-button href="#" tabindex="-1" class="show-password" @click="toggleHidePassword">
              <b-icon scale="1.5" :icon="model.hidepassword?'eye':'eye-slash'" />
            </b-button>
          </b-input-group>
        </b-modal>
        <b-modal @ok="KFK.copyDoc" v-model="show.dialog.copyDocDialog" title="复制白板" button-size="sm" centered size="md">
          <b-form>
            <b-input-group prepend="新白板名" class="pt-2 px-5">
              <b-form-input id="docName" trim v-model="model.copyToDocName" :state="state.copydoc.name"
                class="mb-2 mr-sm-2 mb-sm-0" placeholder=""></b-form-input>
              <b-form-invalid-feedback id="docName-feedback">
                名称为3个以上英文或中文字符，不超过20个
              </b-form-invalid-feedback>
            </b-input-group>
            <!-- move doc  copy doc-->
            <b-input-group prepend="拷贝到哪" class="pt-2 px-5">
              <b-form-select id="docPrj" v-model="model.copyToPrjId" :options="prjListOptions">
                <template v-slot:first>
                  <b-form-select-option :value="null" disabled>-- 请选择项目 --</b-form-select-option>
                </template>
              </b-form-select>
            </b-input-group>
            <b-input-group prepend="是否移动" class="pt-2 px-5" v-if="model.showCopyOrMove" label-cols="3"
              label-align="right" label="" label-for="checkbox-1">
              <b-form-checkbox id="checkbox-1" v-model="model.check.copyOrMove" name="checkbox-1" value="move"
                unchecked-value="copy">
                移动文档到新项目
              </b-form-checkbox>
            </b-input-group>
          </b-form>
          <b-button variant="outline-none" v-b-popover.hover.top="model.showHelp?'':'点击查看帮助说明'"
            @click="KFK.toggleShowHelp">
            <b-icon icon="question-square"></b-icon>
          </b-button>
          <div v-if="model.showHelp" class="inner-help">
            <ul>操作说明
              <li>
                <ol>复制白板
                  <li>目标项目与当前项目一致, 输入新白板名, 以复制一个使用新名称的白板出来; </li>
                  <li>目标项目与当前项目不一致, 将复制一个白板到新项目, 复制后的白板名支持同步修改 </li>
                </ol>
              </li>
              <li>
                <ol>移动白板
                  <li>目标项目与当前项目不一致, 并选择移动模式, 则移动白板到新项目, 同时将移动后的白板名设为新白板名 </li>
                </ol>
              </li>
              <li>
                <ol>白板改名
                  <li>目标项目与当前项目保持一致, 录入新名字, 并选择移动模式, 即实现在同一个项目中对白板进行改名 </li>
                </ol>
              </li>
            </ul>
          </div>
        </b-modal>
        <b-modal @ok="KFK.setAcl" v-model="show.dialog.setAclDialog" title="设置访问范围" button-size="sm" centered size="md">
          <b-form>
            <b-form-group label="请选择访问范围">
              <b-form-radio v-model="model.currentDoc.acl" name="aclRadios" value="S">仅发起人: 只有发起人自己可以使用</b-form-radio>
              <b-form-radio v-model="model.currentDoc.acl" name="aclRadios" value="O">所在组织: 在白板所属组织内使用</b-form-radio>
              <b-form-radio v-model="model.currentDoc.acl" name="aclRadios" value="P">公开使用: 不限制使用范围</b-form-radio>
            </b-form-group>
          </b-form>
          <b-button variant="outline-none" v-b-popover.hover.top="model.showHelp?'':'点击查看帮助说明'"
            @click="KFK.toggleShowHelp">
            <b-icon icon="question-square"></b-icon>
          </b-button>
          <div v-if="model.showHelp" class="inner-help">
            <ul><B>访问范围说明</B>
              <li><B>仅发起人</B>: 只有白板发起人可以使用
              </li>
              <li><B>所在组织</B>: 在白板所属组织(创建时发起人的组织)内使用
              </li>
              <li><B>公开可见</B>: 不限制使用范围
              </li>
              <li><B>白板的访问控制</B>: 结合 访问范围+密码保护+只读设置
              </li>
            </ul>
          </div>
        </b-modal>
        <b-modal id="modal-setuserprofile" @ok="KFK.setUserProfile" v-model="show.dialog.setProfileDialog"
          :title="'当前用户: ' + model.cocouser.userid" button-size="sm" centered class="profileform">
          <div class="profileform">
            <b-form autocomplete="off" class="w-100 px-2" @submit.stop.prevent="KFK.handleProfileSubmit">
              <b-input-group prepend="显示名" class="mb-1">
                <b-form-input id="profile_name" trim v-model="model.profileToSet.name" :state="state.profile.name"
                  required placeholder="新显示名"></b-form-input>
                <b-form-invalid-feedback id="profile_name-feedback">
                  2-10个英文/数字/汉字
                </b-form-invalid-feedback>
              </b-input-group>
              <b-input-group prepend="原密码" class="mb-1">
                <b-form-input id="profile_oldpwd" trim :type="model.hidepassword?'password':'text'"
                  v-model="model.profileToSet.oldpwd" :state="state.profile.oldpwd"
                  required></b-form-input>
                <b-form-invalid-feedback id="profile_oldpwd-feedback">
                  密码至少8字符，<BR>必须含大小写字母数字和特殊字符
                </b-form-invalid-feedback>
              </b-input-group>
              <b-input-group prepend="新密码" class="mb-1">
                <b-form-input :type="model.hidepassword?'password':'text'" class="no-right-border" required trim
                  id="profile_newpwd" tabindex="3" 
                  v-model="model.profileToSet.newpwd" 
                  :state="state.profile.newpwd" 
                  placeholder="8个以上字母数字特殊字符">
                </b-form-input>
                <span class="right-eye-span"> <b-button href="#" tabindex="-1" class="show-password" @click="toggleHidePassword" variant="outline-none"> <b-icon scale="1" :icon="model.hidepassword?'eye':'eye-slash'" /> </b-button> </span>
                <b-form-invalid-feedback id="profile_newpwd-feedback">
                  密码至少8字符，<BR>必须含大小写字母数字和特殊字符
                </b-form-invalid-feedback>
              </b-input-group>
              <b-input-group prepend="新密码" class="mb-1">
                <b-form-input id="profile_newpwd2" trim :type="model.hidepassword?'password':'text'"
                  v-model="model.profileToSet.newpwd2" :state="state.profile.newpwd2" class="no-right-border"
                  required placeholder="密码二次输入确认"></b-form-input>
                <span class="right-eye-span">
                  <b-button href="#" tabindex="-1" class="show-password" @click="toggleHidePassword" variant="outline-none"> <b-icon scale="1" :icon="model.hidepassword?'eye':'eye-slash'" /> </b-button>
                </span>
                <b-form-invalid-feedback id="profile_newpwd2-feedback">
                  两次输入密码必须一样
                </b-form-invalid-feedback>
              </b-input-group>
              <b-row>
                <b-col cols="12"> 换头像需要输入原密码 </b-col>
              </b-row>
              <b-container class="w-100"
                style="height: 148px; white-space:nowrap; overflow-x:auto; overflow-y:scroll; ">
                <b-row>
                  <b-col v-for="avatar in model.avatars" v-bind:key="avatar.id"
                    :class="avatar.id === model.cocouser.avatar?'mb-1 avatar-selected myhovered':'mb-1 myhovered'"
                    v-on:click='EXP.setProfileAvatar($event, avatar.id)'>
                    <b-img :src="avatar.src" class="avatarimg" style="width:48px; height:48px" />
                  </b-col>
                </b-row>
              </b-container>
            </b-form>
          </div>
        </b-modal>
        <b-modal v-model="show.dialog.ivtCodeDialog" title="邀请使用可获得操作积分奖励" button-size="sm" centered size="md">
          请复制一下地址,分享给你的同事或朋友, 他们成功注册后,你将获得1000个操作积分!
          <b-form-input :value="getInvitationUrl()">hello</b-form-input>
        </b-modal>

      </div> <!-- explorer inner -->
      <div id="gotodesignercontrol" v-show="model.docLoaded" class="padlayout noshow">
        <b-button-group class="coco">
          <b-button id="goto_designer" variant="outline-success" @click="KFK.gotoDesigner">
            <b-icon icon="pencil"></b-icon>
          </b-button>
        </b-button-group>
      </div>
      <div> <b-link v-on:click="KFK.gotoExplorerTab(2)" class="explorer-user-orgname">
            {{model.cocouser.orgname}}</b-link>
      </div>
    </div> <!-- explorer -->
    <!--minimap-->
    <div id="various_modals">
      <div id="shareDialog" v-show="show.dialog.shareDialog" title="分享文档" button-size="sm" centered size="md"
        class="noshow">
        <b-container>
          <b-form>
            <b-row>
              <b-col cols=4>
                <b-img :src="KFK.images['share'].src"></b-img>
              </b-col>
              <b-col class="shareItTips">
                请复制分享地址, 你可以通过任意沟通工具, 把邀请连接粘贴给需要分享的人。
                接受分享者,在成功注册后,您和白板协作发起人都将获得操作积分奖励
              </b-col>
            </b-row>
            <b-row class="text-center mt-3" cols=8>
              <b-col class="mt-3">
                <b-form-input id="shareItUrl" class="share-it-url" trim v-model="model.share.url"></b-form-input>
              </b-col>
              <div class="w-100"></div>
              <b-col class="mt-2">
                <b-button variant="outline-secondary" size="sm" class="mb-2" v-on:click="SHARE.cancelShare">
                  <b-icon icon="x"></b-icon>取消
                </b-button>
                <b-button id="shareItBtn" variant="outline-primary" size="sm" class="mb-2">
                  <b-icon icon="box-arrow-up"></b-icon>复制地址
                </b-button>
              </b-col>
            </b-row>
          </b-form>
        </b-container>
      </div>
      <b-modal @ok="KFK.placePastedContent" v-model="show.dialog.pasteContentDialog" title="请选择粘贴方式" button-size="sm"
        centered size="md">
        <b-container>
          <b-row v-show="model.paste.showcontent">
            <b-col cols="12">粘贴内容
              <b-form-input disabled trim type="text" v-model="model.paste.content"> </b-form-input>
            </b-col>
          </b-row>
          <b-row v-show="model.paste.showdisplay">
            <b-col cols="12">显示文字
              <b-form-input trim type="text" v-model="model.paste.display"> </b-form-input>
            </b-col>
          </b-row>
          <b-row v-show="model.paste.showbox">
            <b-col cols="12">是否显示边框及底色
              <b-form-radio-group v-model="model.paste.box" :options="model.paste.options" class="mb-3"
                value-field="item" text-field="name" disabled-field="notEnabled">
              </b-form-radio-group>
            </b-col>
          </b-row>
        </b-container>
      </b-modal>
      <b-modal @ok="KFK.msgOK" v-model="show.dialog.MsgBox" :title="model.msgbox.title" button-size="sm" centered
        size="md" class="noshow">
        <b-container>
          <b-row>
            <b-col cols="12">
              {{model.msgbox.content}}
            </b-col>
          </b-row>
        </b-container>
      </b-modal>
    </div> <!-- modals-->
    <div class="mb-2 loading noshow  text-center">
      {{ model.loading_value }}%加载中请稍候
    </div>
    <!--doc loading-->
    <div v-show="show.form.doclist" class="docopmenu noshow" @click="KFK.hideDocOpMenu();">
      <div class="docopmenu_main">
        <b-col class="myhovered" @click="KFK.showCopyDocDialog(model.currentDoc); KFK.hideDocOpMenu();">
          <b-button v-if="model.currentDoc" class="m-0 p-0 avatarimg" variant="outline-none">
            <b-icon icon="files" variant="secondary"></b-icon>复制
          </b-button>
        </b-col>
        <b-col class="myhovered" @click="SHARE.shareDoc(model.currentDoc); KFK.hideDocOpMenu();">
          <b-button class="m-0 p-0  avatarimg" variant="outline-none">
            <b-icon icon="box-arrow-up" variant="secondary"></b-icon>分享
          </b-button>
        </b-col>
        <b-col class="myhovered" @click="deleteDocItem(model.currentDoc); KFK.hideDocOpMenu();">
          <b-button v-if="model.currentDoc && model.currentDoc.owner===model.cocouser.userid" class="m-0 p-0 avatarimg"
            variant="outline-none">
            <b-icon icon="trash" variant="secondary"></b-icon>删除
          </b-button>
        </b-col>
        <b-col class="myhovered" @click="KFK.showSetAclDialog(model.currentDoc); KFK.hideDocOpMenu();">
          <b-button v-if="model.currentDoc && model.currentDoc.owner===model.cocouser.userid" class="m-0 p-0 avatarimg"
            variant="outline-none">
            <b-icon icon="shield-shaded" variant="secondary"></b-icon>权限
          </b-button>
        </b-col>
      </div>
      <div class="docopmenu_pointer"></div>
    </div>
    <div id="copydiv" style="display: none; z-index: -99999"></div>
    <div id="centerpoint" class="centerpoint noshow"></div>
  </div>
  <!--app-->
</body>
<script src="./pad.js"></script>

</html>