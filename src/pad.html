<!DOCTYPE html>
<html>

<head>
  <title>COCOPAD</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="stylesheet" href="../my-styles/style.css">
  <link rel="shortcut icon" href="./favicon.ico" />
</head>

<body>
  <div id="containerbkg"></div>
  <img style="display:none;" id='defaultavatar' src='../assets/avatar/avatar-0.svg' />

  <div id='app' class='fontFancyColor'>
    <b-button v-show="show.section.login" pill variant='outline-success' class='reglogin' @click="KFK.showRegisterForm">
      注 册</b-button>
    <b-button v-show="show.section.register" pill variant='outline-success' class='reglogin' @click="KFK.showLoginForm">
      登 录</b-button>
    <div class="msgarea">
      <b-row class="w-100">
        <b-col class="text-center">
          <div id="MSG"></div>
        </b-col>
      </b-row>
    </div>
    <img v-show="!show.section.designer" src="../assets/cocopad.svg" class='left_top_logo_image' />
    <div class="cocoslogon" v-show="!show.section.designer">
      <b-row class="text-center py-2">
        <b-col style='font-size: 28px;'>共创白板</b-col>
      </b-row>
      <b-row class="text-center" v-show="!show.wsready || show.section.register || show.section.login">
        <b-col style='font-size:18px;'>在线协作 高效沟通</b-col>
      </b-row>
    </div>
    <div class="leftbkg" v-show="!show.section.designer">
      <div class='left_menu noshow' id="left_menu">
        <b-container v-show="!show.wsready || show.section.register || show.section.login">
          <b-row class="text-center mt-5">
            <b-col> <img src="../assets/brainstorm.svg" class='left_top_image' /> </b-col>
          </b-row>
          <b-row class="text-center py-1">
            <b-col style='font-size:18px;'> 头脑风暴 </b-col>
          </b-row>
          <b-row class="text-center mt-2">
            <b-col> <img src="../assets/home_office.svg" class='left_top_image' /> </b-col>
          </b-row>
          <b-row class="text-center py-1">
            <b-col style='font-size:18px;'> 远程办公 </b-col>
          </b-row>
          <b-row class="text-center mt-2">
            <b-col> <img src="../assets/meetingroom.svg" class='left_top_image' /> </b-col>
          </b-row>
          <b-row class="text-center py-1">
            <b-col style='font-size:18px;'> 在线会议 </b-col>
          </b-row>
          <b-row class="text-center mt-2">
            <b-col> <img src="../assets/design.svg" class='left_top_image' /> </b-col>
          </b-row>
          <b-row class="text-center py-1">
            <b-col style='font-size:18px;'> 联合设计 </b-col>
          </b-row>
          <b-row class="text-center mt-2">
            <b-col> <img src="../assets/collaboration.svg" class='left_top_image' /> </b-col>
          </b-row>
          <b-row class="text-center py-1">
            <b-col style='font-size:18px;'> 在线协作 </b-col>
          </b-row>
          <b-row class="text-center mt-2">
            <b-col> <img src="../assets/classroom.svg" class='left_top_image' /> </b-col>
          </b-row>
          <b-row class="text-center py-1">
            <b-col style='font-size:18px;'> 远程教学 </b-col>
          </b-row>
          <b-row class="text-center mt-2">
            <b-col> <img src="../assets/km.svg" class='left_top_image' /> </b-col>
          </b-row>
          <b-row class="text-center py-1">
            <b-col style='font-size:18px;'> 知识管理 </b-col>
          </b-row>
        </b-container>
      </div>
    </div>
    <div id="waiting" v-show="!show.wsready" class="waitinglogo">
      <b-container>
        <b-row cols="3" align-v='center'>
          <b-col>
            <b-iconstack font-scale="6">
              <b-icon stacked icon="cloud" variant="info" scale="1.5"></b-icon>
              <b-icon stacked icon="three-dots" variant="danger" scale="0.8" shift-v="-2.5" animation="cylon"></b-icon>
            </b-iconstack>
          </b-col>
          <b-col>
            <b-icon icon="three-dots" animation="cylon" font-scale="3" color="#7952b3"></b-icon>
          </b-col>
          <b-col>
            <img src="../assets/cocopad.svg" class="logo d-inline-block align-top" alt="COCOPAD">
          </b-col>
        </b-row>
      </b-container>
    </div>
    <div id="registerform" class="registerform" v-show="show.section.register" style="display:none;">
      <b-container class="my-3 ">
        <b-form autocomplete="off" class="w-100 px-2">
          <b-row>
            <b-col class="text-right pb-4" style="font-size:28px">
              新用户注册
            </b-col>
          </b-row>
          <b-form-group label-cols=3 label="新用户ID" label-for="regUserId" label-align="right">
            <b-form-input id="regUserId" trim v-model="model.register.userid" :state="state.reg.userid"
              class="mb-2 mr-sm-2 mb-sm-0" required placeholder="请使用正确的邮箱地址" class="w-50"></b-form-input>
            <b-form-invalid-feedback id="regUserId-feedback">
              一个正确的邮箱地址
            </b-form-invalid-feedback>
          </b-form-group>
          <b-form-group label-cols=3 label="全名" label-for="regUserName" label-align="right">
            <b-form-input id="regUserName" trim v-model="model.register.name" :state="state.reg.name"
              class="mb-2 mr-sm-2 mb-sm-0" required placeholder="您的全称" class="w-50"></b-form-input>
            <b-form-invalid-feedback id="regUserName-feedback">
              2个以上汉字或4个以上英文，最多10个
            </b-form-invalid-feedback>
          </b-form-group>
          <b-form-group label-cols=3 label="用户密码" label-for="regUserPwd" label-align="right">
            <b-form-input id="regUserPwd" trim :type="model.hidepassword?'password':'text'" v-model="model.register.pwd"
              :state="state.reg.pwd" class="mb-2 mr-sm-2 mb-sm-0" required placeholder="" class="w-50"></b-form-input>
            <b-form-invalid-feedback id="regUserPwd-feedback">
              密码至少8字符，<BR>必须含大小写字母数字和特殊字符
            </b-form-invalid-feedback>
          </b-form-group>
          <b-form-group label-cols=3 label="再次录入" label-for="regUserPwd2" label-align="right">
            <b-form-input id="regUserPwd2" trim :type="model.hidepassword?'password':'text'"
              v-model="model.register.pwd2" :state="state.reg.pwd2" class="mb-2 mr-sm-2 mb-sm-0" required placeholder=""
              class="w-50"></b-form-input>
            <b-form-invalid-feedback id="regUserPwd2-feedback">
              两次密码输入需要一致
            </b-form-invalid-feedback>
            <b-button @click="toggleHidePassword" variant="outline-none">
              <b-icon scale="1.5" :icon="model.hidepassword?'eye':'eye-slash'" />
            </b-button>
          </b-form-group>
          <div class="bg-none text-right">
          </div>
          <b-row>
            <b-col cols=6>
            </b-col>
            <b-col cols=6 class="bg-none text-right">
              <b-button @click="KFK.registerUser" variant="outline-primary">注册账号 &gt;&gt;</b-button>
            </b-col>
          </b-row>
        </b-form>
      </b-container>
      <b-container style="position: absolute; bottom: 20px;">
        <b-row class="w-100 text-center">
          <b-col class="pt-3"><a href="#" class="card-link" @click="KFK.showLoginForm"
              style='font-size:18px'>已有账号？请登录</a>
          </b-col>
          <div class="w-100">
            <hr>
          </div>
          </b-col>
          <b-col><a href="#" class="card-link" @click="KFK.createDemoEnv">先不注册 直接体验</a>
            <div class="w-100"></div>
            <b-col><a href="#" class="card-link" @click="KFK.showHelp">帮助</a></b-col>
        </b-row>
        </b-form>
      </b-container>
    </div>
    <div id="loginform" class="loginform" v-show="show.section.login" style="display:none;">
      <b-container class="my-3 ">
        <b-form autocomplete="off" class="w-100 px-2">
          <b-row>
            <b-col class="text-right pb-4" style="font-size:28px">
              请登录
            </b-col>
          </b-row>
          <b-form-group label-cols=3 label="用户ID" label-for="userId" label-align="right">
            <b-form-input id="userId" trim v-model="model.login.userid" class="mb-2 mr-sm-2 mb-sm-0" placeholder=""
              class="w-50"></b-form-input>
          </b-form-group>
          <b-form-group label-cols="3" label="用户密码" label-for="userPwd" label-align="right">
            <b-form-input id="userPwd" trim :type="model.hidepassword?'password':'text'" v-model="model.login.pwd"
              class="mb-2 mr-sm-2 mb-sm-0" placeholder="" class="w-50"></b-form-input>
            <b-button @click="toggleHidePassword" variant="outline-none">
              <b-icon scale="1.5" :icon="model.hidepassword?'eye':'eye-slash'" />
            </b-button>
          </b-form-group>
          <div class="bg-none text-right">
            <b-button @click="KFK.signin" variant="outline-primary">登录 &gt;&gt;</b-button>
          </div>
        </b-form>
      </b-container>
      <b-container style="position: absolute; bottom: 20px;">
        <b-row class="w-100 text-center">
          <b-col class="pt-3"><a href="#" @click="KFK.showRegisterForm" style='font-size:18px'>还没有账号？新用户注册</a></b-col>
          </b-col>
          <div class="w-100">
            <hr>
          </div>
          <b-col><a href="#" class="card-link" @click="KFK.showHelp">帮助</a></b-col>
        </b-row>
        </b-form>
      </b-container>
    </div>

    <div v-show="show.section.designer" style="display:none;">
      <div id="scroll-container">
        <div id="containermain">
          <div id="C3">
          </div>
          <div id="boundingrect" class="boundingrect"></div>
          <div id="selectingrect" class="selectingrect"></div>
        </div>
      </div>
      <div id="toplogo" class="padlayout">
        <b-navbar toggleable="lg" type="light">
          <b-navbar-brand>
            <img src="../assets/cocopad.svg" class="logo d-inline-block align-top" alt="COCOPAD">
            <span class='lkh' id="greeting">在线协作白板</span>
          </b-navbar-brand>
        </b-navbar>
      </div>

      <div id="left" class="bg-white padlayout noshow">
        <b-list-group>
          <b-list-group-item href="#" class="d-flex align-items-center" @click="setMode('pointer');"
            :active="active['pointer']">
            <b-img :src="images['pointer'].src" fluid alt="" scale="2" class="cocotool"></b-img>
          </b-list-group-item>
          <b-list-group-item href="#" class="d-flex align-items-center" @click="setMode('text');"
            :active="active['text']">
            <b-img :src="images['text'].src" fluid alt="" scale="2" class="cocotool"></b-img>
          </b-list-group-item>
          <b-list-group-item href="#" class="d-flex align-items-center" @click="setMode('textblock');"
            :active="active['textblock']">
            <b-img :src="images['textblock'].src" fluid alt="" scale="2" class="cocotool"></b-img>
          </b-list-group-item>
          <b-list-group-item href="#" class="d-flex align-items-center" @click="setMode('yellowtip');"
            :active="active['yellowtip']">
            <b-img :src="images['tip'].src" fluid alt="" scale="2" class="cocotool"></b-img>
          </b-list-group-item>
          <b-list-group-item href="#" class="d-flex align-items-center" @click="setMode('line');"
            :active="active['line']">
            <b-img :src="images['line'].src" fluid alt="" scale="2" class="cocotool" id='tool_line'></b-img>
          </b-list-group-item>
          <b-list-group-item href="#" class="d-flex align-items-center" @click="setMode('connect');"
            :active="active['connect']">
            <b-img :src="images['connect'].src" fluid alt="" scale="2" class="cocotool" id='tool_connect'></b-img>
          </b-list-group-item>
          <b-list-group-item href="#" class="d-flex align-items-center" @click="setMode('lock');"
            :active="active['lock']">
            <b-img :src="images['lock'].src" fluid alt="" scale="2" class="cocotool" id='tool_lock'></b-img>
          </b-list-group-item>
          <b-list-group-item class="m-0 p-0">
            <b-icon icon="blank" scale="0.5"></b-icon>
          </b-list-group-item>
          <b-list-group-item href="#" class="d-flex align-items-center" @click="KFK.toggleMinimap();"
            :active="active['minimap']">
            <b-icon icon="map" scale="1.5" shift-h="4" fluid alt="" class="cocotool" id='tool_minimap'></b-icon>
          </b-list-group-item>

        </b-list-group>
      </div>
      <div id="right" class="padlayout noshow">
        <b-tabs v-model="model.rightTabIndex" content-class="mt-3" justified>
          <b-tab title="样式" class='cocoproperty'>
            <b-container v-show="show.customshape">
              <b-row class="mx-auto my-1">
                <b-col>背景底色</b-col>
                <b-col class='coco'><input class="w-100" name="shapeBkgColor" id="shapeBkgColor" /></b-col>
              </b-row>
              <b-row class="mx-auto my-1">
                <b-col>边框颜色</b-col>
                <b-col class='coco'><input name="shapeBorderColor" id="shapeBorderColor" /></b-col>
              </b-row>
              <b-row class="mx-auto my-1">
                <b-col>边框粗细</b-col>
                <b-col class='coco'><input class='selector' size=3 id="spinner_border_width" name="value_bw" /></b-col>
              </b-row>
              <b-row class="mx-auto my-1">
                <b-col>圆角度数</b-col>
                <b-col class='coco'><input class='selector' size=3 id="spinner_border_radius" name="value_rad" />
                </b-col>
              </b-row>
            </b-container>
            <b-container v-show="show.customline">
              <b-row class="mx-auto my-1">
                <b-col>线条颜色</b-col>
                <b-col class='coco'><input name="lineColor" id="lineColor" /></b-col>
              </b-row>
              <b-row class="mx-auto my-1">
                <b-col>线条粗细</b-col>
                <b-col class='coco'><input class='selector' size=3 id="spinner_line_width" name="value_lw" /></b-col>
              </b-row>
              <b-row class="mx-auto my-1">
                <b-checkbox id="cb-linecap" v-model="model.line.linecap" name="cb-linecap" switch
                  @change="KFK.lineCapChanged">
                  圆头线条
                </b-checkbox>
              </b-row>
            </b-container>

            <b-container v-show="show.text_property" class='border-top'>
              <div class="row mx-auto my-1">
                <div class="col">文本字体</div>
                <div class="col coco"><input class="fonts p-0" /></div>
              </div>
              <div class="row mx-auto my-1">
                <div class="col">文本颜色</div>
                <div class="col coco">
                  <input name="fontColor" id="fontColor" />
                </div>
              </div>
              <div class="row mx-auto my-1">
                <div class="col">横向对齐</div>
                <div class="col coco">
                  <b-form-select id="textAlign" v-model="model.textAlign" :options="model.textAlignOptions"
                    @change="textAlignChanged">
                  </b-form-select>
                </div>
              </div>
              <div class="row mx-auto my-1">
                <div class="col">纵向对齐</div>
                <div class="col coco">
                  <b-form-select id="vertAlign" v-model="model.vertAlign" :options="model.vertAlignOptions"
                    @change="vertAlignChanged">
                  </b-form-select>
                </div>
              </div>
            </b-container>
            <b-container v-show="show.custombacksvg" class='border-top'>
              使用背景图片
              <b-row v-for="tips in tip_groups" v-bind:key="tips[0]">
                <b-col class='p-1' v-for="tip in tips" v-bind:key="tip">
                  <b-img :src="images[tip].src" fluid alt="" scale="2" class="cocotool" @click="setTipVariant(tip)">
                  </b-img>
                </b-col>
              </b-row>
              <b-row class="mx-auto my-1">
                <b-col>底图颜色</b-col>
                <b-col class='coco'><input name="tipBkgColor" id="tipBkgColor" /></b-col>
              </b-row>
            </b-container>
          </b-tab>
          <b-tab title="排列">
            <b-button-toolbar v-show="show.layercontrol" key-nav class="w-100 justify-content-md-center">
              <p>图层设置</p>
              <b-button-group class="d-flex w-100" title="hello">
                <b-button variant="light" title="到最上(T)" class="flex-fill p-0" @click="KFK.ZiToTop()">
                  <b-icon icon="chevron-double-up" />
                </b-button>
                <b-button variant="light" title="上一层(H)" class="flex-fill p-0" @click="KFK.ZiToHigher()">
                  <b-icon icon="chevron-up" />
                </b-button>
                <b-button variant="light" title="下一层(G)" class="flex-fill p-0" @click="KFK.ZiToLower()">
                  <b-icon icon="chevron-down" />
                </b-button>
                <b-button variant="light" title="到最下(B)" class="flex-fill p-0" @click="KFK.ZiToBottom()">
                  <b-icon icon="chevron-double-down" />
                </b-button>
              </b-button-group>
            </b-button-toolbar>
            <b-button-toolbar v-show="show.arrange_multi_nodes" key-nav class="w-100 justify-content-md-center">
              <p>对齐设置</p>
              <b-button-group class="d-flex w-100">
                <b-button variant="light" title="对齐左侧" class="flex-fill p-0" @click="KfkAlign('left')"><img
                    src="../assets/align_left.svg" class="toolbar"></b-button>
                <b-button variant="light" title="对齐垂直中线" class="flex-fill p-0" @click="KfkAlign('center')"><img
                    src="../assets/align_center.svg" class="toolbar"></b-button>
                <b-button variant="light" title="对齐右侧" class="flex-fill p-0" @click="KfkAlign('right')"><img
                    src="../assets/align_right.svg" class="toolbar"></b-button>
                <b-button variant="light" title="对齐顶部" class="flex-fill p-0" @click="KfkAlign('top')"><img
                    src="../assets/align_top.svg" class="toolbar"></b-button>
                <b-button variant="light" title="对齐水平中线" class="flex-fill p-0" @click="KfkAlign('middle')"><img
                    src="../assets/align_middle.svg" class="toolbar"></b-button>
                <b-button variant="light" title="对齐底部" class="flex-fill p-0" @click="KfkAlign('bottom')"><img
                    src="../assets/align_bottom.svg" class="toolbar"></b-button>
              </b-button-group>
            </b-button-toolbar>
            <b-button-toolbar v-show="show.arrange_multi_nodes" key-nav class="w-100 justify-content-md-center">
              <b-button-group class="d-flex w-100">
                <b-button variant="light" class="flex-fill" title="横向均匀分布" @click="KfkAlign('hori')"><img
                    src="../assets/align_hori.svg" class="toolbar"></b-button>
                <b-button variant="light" class="flex-fill" title="纵向均匀分布" @click="KfkAlign('vert')"><img
                    src="../assets/align_vert.svg" class="toolbar"></b-button>
              </b-button-group>
            </b-button-toolbar>
          </b-tab>
          <b-tab title="COCO" active class='cocoproperty'>
            <p>欢迎使用</p>
            <b-checkbox id="cb-showgrid" v-model="model.cococonfig.showgrid" name="cb-showgrid" switch
              @change="showGridChanged">
              显示网格线
            </b-checkbox>
            <b-checkbox v-model="model.cococonfig.snap" switch @change="snapChanged">
              对齐到网格
            </b-checkbox>
            <b-checkbox v-model="model.cococonfig.showlock" switch @change="KFK.showLockChanged">
              显示锁定标志
            </b-checkbox>
            <p> </p>
            <b-container class="coco">
              <b-row class="mx-auto my-1">
                <b-col>背景颜色</b-col>
                <b-col class="coco">
                  <b-form-input v-model="model.cococonfig.bgcolor" name="cocoBkgColor" id="cocoBkgColor" />
                </b-col>
              </b-row>
            </b-container>
            <b-container class="coco">
              <b-row class="mx-auto my-1">
                <b-col>显示编辑者</b-col>
              </b-row>
              <b-row class="mx-auto my-1">
                <b-form-radio v-model="model.showEditor" name="some-radios" value="none"
                  @change="showEditorChanged('none')">隐藏</b-form-radio>
                <b-form-radio v-model="model.showEditor" name="some-radios" value="last"
                  @change="showEditorChanged('last')">最近</b-form-radio>
                <b-form-radio v-model="model.showEditor" name="some-radios" value="all"
                  @change="showEditorChanged('all')">全部</b-form-radio>
              </b-row>
            </b-container>
          </b-tab>
          </b-tab>
        </b-tabs>
      </div>
      <b-button-group class="coco padlayout" id='actionlog_button'>
        <b-button @click="KFK.showActionLog" class="" variant="outline-success">
          <b-icon icon="people"></b-icon> 参与者
        </b-button>
        <b-button id='sharethisbutton' @click="KFK.shareThisDoc" class="" variant="outline-success">
          <b-icon icon="box-arrow-up"></b-icon>分享
        </b-button>
      </b-button-group>
      <div id="rtcontrol" class="padlayout noshow">
        <b-button-group class="coco">
          <b-button id="zoom_in" variant="outline-success" @click="KFK.zoomIn">
            <b-iconstack scale="0.6">
              <b-icon icon="plus" shift-h="-1.2" shift-v="1.1"></b-icon>
              <b-icon icon="search"></b-icon>
            </b-iconstack>
          </b-button>
          <b-button id="zoom_1" variant="outline-success" @click="KFK.zoomStop">
            <b-iconstack scale="0.6">
              <b-icon icon="x" shift-h="-1.2" shift-v="1.1"></b-icon>
              <b-icon icon="search"></b-icon>
            </b-iconstack>
          </b-button>
          <b-button id="zoom_out" variant="outline-success" @click="KFK.zoomOut">
            <b-iconstack scale="0.6">
              <b-icon icon="dash" shift-h="-1.2" shift-v="1.1"></b-icon>
              <b-icon icon="search"></b-icon>
            </b-iconstack>
          </b-button>
        </b-button-group>
        <b-button-group class="coco">
          <b-button id="goto_explorer" variant="outline-success" @click="KFK.gotoExplorer">
            <b-icon icon="folder"></b-icon>
          </b-button>
          <b-button v-show="!model.cocodoc.readonly" id="toggle_all" variant="outline-success"
            @click="KFK.toggleFullScreen">
            <b-icon icon="arrows-fullscreen"></b-icon>
          </b-button>
          <b-button v-show="!model.cocodoc.readonly" id="toggle-right" variant="outline-success"
            @click="KFK.toggleRight">
            <b-icon icon="layout-sidebar-reverse"></b-icon>
          </b-button>
        </b-button-group>
      </div>
      <div id="actionloglist" v-show="show.actionlog" style="overflow-y:scroll" class="p-3">
        协作参与者
        <div id='actionlog-refresh'>
          <b-button @click="KFK.getActionLog" variant="link" class="m-0 p-0">刷新</b-button>
        </div>
        <div id='actionlog-close'>
          <b-button @click="KFK.showActionLog" variant="link" class="m-0 p-0">关闭</b-button>
        </div>
        <b-list-group>
          <b-list-group-item v-for="(actionlog,index) in model.actionlog" v-bind:index="index" v-bind:key="'hl'+index"
            class="d-flex flex-nowrap text-nowrap">
            <b-container class="m-0 p-0">
              <b-row class="pb-1">
                <b-col cols="10" style="width:100px; white-space:nowrap; overflow-x:scroll; overflow-y:hidden;">
                  <img :src="actionlog.avatarSrc" class="avatar-in-line" />
                  {{actionlog.name}}</b-col>
                <b-col cols="2">
                  <b-badge variant="primary" pill>{{actionlog.logs.length}}</b-badge>
                </b-col>
              </b-row>
              <b-row>
                <b-button-group size="sm" class="w-100">
                  <b-button size="sm" @click="KFK.navActionLog(actionlog,  'first')" variant="outline-primary">
                    <b-icon icon="skip-start-fill" variant="primary"> </b-icon>
                  </b-button>
                  <b-button size="sm" @click="KFK.navActionLog(actionlog,  'prev')" variant="outline-primary">
                    <b-icon icon="caret-left-fill" variant="primary"> </b-icon>
                  </b-button>
                  <b-button size="sm" @click="KFK.navActionLog(actionlog,  'next')" variant="outline-primary">
                    <b-icon icon="caret-right-fill" variant="primary"></b-icon>
                  </b-button>
                  <b-button size="sm" @click="KFK.navActionLog(actionlog,  'last')" variant="outline-primary">
                    <b-icon icon="skip-end-fill" variant="primary"> </b-icon>
                  </b-button>
                </b-button-group>
              </b-row>
            </b-container>
          </b-list-group-item>
        </b-list-group>
      </div>
      <b-container class="docname">
        <b-row>
          <b-col v-show="model.cocodoc.readonly" md="auto">
            <b-icon icon="lock" variant="secondary"></b-icon>
          </b-col>
          <b-col>{{model.cocodoc.name}}</b-col>
        </b-row>
      </b-container>
      <div id="modeIndicator" style="position:absolute; top: 0px; left: 0px; display: none; ">
        <img id="modeIndicatorImg" src="../assets/pointer.svg" style='width: 18px; height: 18px;' />
      </div>
      <img id="linetransformer" src="../assets/linetransformer.svg"
        style="position: absolute; top:10px; height: 10px; width: 20px; height: 20px; z-index: 9999; visibility: hidden;" />
    </div>

    <div class="explorer" v-show="show.section.explorer" style="display:none;">
      <div class="inner">
        <b-navbar type="light" variant="light">
          <b-navbar-nav class="mr-auto">
            <b-navbar-brand href="#">
            </b-navbar-brand>
          </b-navbar-nav>
          <b-navbar-nav class="mr-auto">
            <b-nav-item @click="KFK.showCreateNewPrj">新建项目</b-nav-item>
          </b-navbar-nav>
          <b-navbar-nav class="mr-auto">
            <b-nav-item @click="KFK.showCreateNewDoc">新建文档</b-nav-item>
          </b-navbar-nav>
          <b-navbar-nav>
            <div v-show="model.cocouser.avatar_src">
              <img :src="model.cocouser.avatar_src" style="width:40px; height: 40px;" />
            </div>
            <b-nav-item-dropdown text="我的" right>
              <b-dropdown-item-button>{{model.cocouser.name}}</b-dropdown-item-button>
              <b-dropdown-item-button @click="KFK.showSetProfileDialog()">账户信息</b-dropdown-item-button>
              <b-dropdown-divider></b-dropdown-divider>
              <b-dropdown-item-button @click="KFK.showPrjs">我的项目</b-dropdown-item-button>
              <b-dropdown-item-button @click="KFK.showDocs">我的白板</b-dropdown-item-button>
              <b-dropdown-divider></b-dropdown-divider>
              <b-dropdown-item-button v-if="model.isDemoEnv" @click="KFK.upgradeToStartAccount">注册为正式用户
              </b-dropdown-item-button>
              <b-dropdown-item-button v-else @click="KFK.signOut">退出登录状态</b-dropdown-item-button>
            </b-nav-item-dropdown>
          </b-navbar-nav>
        </b-navbar>

        <div class="overflow: auto"
          v-show="show.form.newdoc || show.form.newprj || show.form.doclist || show.form.prjlist">
          <b-card no-body>
            <b-tabs card v-model="show.form.explorerTabIndex" vertical
              active-nav-item-class="font-weight-bold text-uppercase text-danger" active-tab-class="">
              <b-tab title="我的项目" @click="KFK.selectPrjTab">
                <div v-show="show.form.newprj">
                  <b-card title="新建项目">
                    <b-form>
                      <b-form-group label-cols=3 label-align="right" label="项目名称" label-for="prjName">
                        <b-form-input id="prjName" trim v-model="model.newprjname" :state="prjNameState"
                          class="mb-2 mr-sm-2 mb-sm-0" placeholder=""></b-form-input>
                        <b-form-invalid-feedback id="prjName-feedback">
                          名称为3个以上英文或中文字符，不超过20个
                        </b-form-invalid-feedback>
                      </b-form-group>
                      <div class="bg-none text-right">
                        <b-button variant="primary" @click="KFK.createNewPrj">发起</b-button>
                      </div>
                    </b-form>
                    <div>&nbsp;</div>
                    <div>&nbsp;</div>
                    <a href="#" class="card-link" @click="KFK.showPrjs">&lt; 返回项目列表</a>
                  </b-card>
                </div>
                <div v-show="show.form.prjlist">
                  {{model.prjwarning}}
                  <b-table hover id="my-prj-table" :items="model.prjs" :per-page="model.perPage"
                    :current-page="model.currentPrjPage" small :fields="model.prjfields"
                    @row-clicked="KFK.prjRowClickHandler">
                    <template v-slot:cell(operation)="data">
                      <b-button v-if="data.item.prjid !== 'all' && data.item.prjid !== 'mine' " size="sm"
                        @click="deletePrjItem(data.item, data.index, $event.target)" class="m-0 p-0"
                        variant="outline-primary">
                        <b-icon icon="trash"></b-icon>
                      </b-button>
                    </template>
                    <template v-slot:cell()="data">
                      {{ data.value }}
                    </template>
                  </b-table>
                  <div>
                    <b-pagination class="justify-content-center" v-model="model.currentPrjPage" :total-rows="prjcount"
                      :per-page="model.perPage" aria-controls="my-prj-table" pills></b-pagination>
                  </div>
                </div>
              </b-tab>
              <b-tab title="我的白板" @click="KFK.selectDocTab">
                <div v-show="show.form.newdoc">
                  <b-card title="新建共创板">
                    <b-card-text>
                      项目 <B>{{model.lastrealproject.name}}</B> 的共创白板
                      <a href="#" class="card-link" @click="KFK.pickPrjForCreateDoc">选择其他项目 &gt;</a>
                    </b-card-text>
                    <b-form>
                      <b-form-group label-cols="3" label-align="right" label="白板名" label-for="docName">
                        <b-form-input id="docName" trim v-model="model.newdocname" :state="docNameState"
                          class="mb-2 mr-sm-2 mb-sm-0" placeholder=""></b-form-input>
                        <b-form-invalid-feedback id="docName-feedback">
                          名称为3个以上英文或中文字符，不超过20个
                        </b-form-invalid-feedback>
                      </b-form-group>
                      <b-form-group label-cols="3" label-align="right" label="访问密码" label-for="docPwd">
                        <b-form-input id="docPwd" :type="model.hidepassword?'password':'text'" trim
                          v-model="model.newdocpwd" class="mb-2 mr-sm-2 mb-sm-0" placeholder=""></b-form-input>
                        <b-button @click="toggleHidePassword" variant="outline-none">
                          <b-icon scale="2" :icon="model.hidepassword?'eye':'eye-slash'" />
                        </b-button>
                      </b-form-group>
                      <div class="bg-none text-right">
                        <b-button variant="primary" @click="KFK.createNewDoc">发起</b-button>
                      </div>
                    </b-form>
                    <div>&nbsp;</div>
                    <div>&nbsp;</div>
                    <a href="#" class="card-link" @click="KFK.showDocs">&lt; 返回文档列表</a>
                  </b-card>
                </div>
                <div v-show="show.form.doclist" style="overflow-y:scroll">
                  <div v-if="model.project.prjid === 'all' || model.project.prjid === 'mine'">
                    <B>{{model.project.name}}</B> 中的共创白板
                  </div>
                  <div v-else> 项目 <B>{{model.project.name}}</B> 中的共创白板 </div>
                  <b-table hover id="my-doc-table" :items="model.docs" :per-page="model.perPage"
                    :current-page="model.currentDocPage" small :fields="model.docfields"
                    @row-clicked="KFK.docRowClickHandler">
                    <template v-slot:cell(copydoc)="data">
                      <b-button size="sm" class="m-0 p-0" variant="outline-primary"
                        @click="KFK.showCopyDocDialog(data.item, data.index, $event.target)">
                        <b-iconstack>
                          <b-icon stack icon="file" shift-h='-3' shift-v='3' scale="0.5"></b-icon>
                          <b-icon stack icon="file" scale="0.5" shift-h="-1" shift-v="1"></b-icon>
                        </b-iconstack>
                      </b-button>
                    </template>
                    <template v-slot:cell(security_icon)="data">
                      <b-button v-if="data.item.owner === model.cocouser.userid" size="sm" class="m-0 p-0"
                        :variant="data.item.security_variant"
                        @click="KFK.showResetPwdModal(data.item, data.index, $event.target)">
                        <b-iconstack>
                          <b-icon stacked :icon="data.item.security_icon" scale="0.85" shift-h="" shift-v="-1">
                          </b-icon>
                        </b-iconstack>
                      </b-button>
                    </template>
                    <template v-slot:cell(readonly_icon)="data">
                      <b-button size="sm" class="m-0 p-0" :variant="data.item.readonly_variant"
                        @click="KFK.setDocReadonly(data.item, data.index, $event.target)">
                        <b-iconstack v-if="data.item.readonly_icon==='lock'" size="sm">
                          <b-icon stacked icon="laptop" flip-v scale="1"></b-icon>
                          <b-icon stacked icon="pie-chart-fill" scale="0.45" shift-h="-2.5" shift-v="-1"></b-icon>
                          <b-icon stacked icon="text-indent-left" scale="0.4" shift-h="3"></b-icon>
                          <b-icon stacked icon="dash" rotate="90" scale="0.6" shift-v="-6"></b-icon>
                        </b-iconstack>
                        <b-icon v-else icon="pencil" size="sm" class="m-0 p-0" />
                      </b-button>
                    </template>
                    <template v-slot:cell(share_icon)="data">
                      <b-button size="sm" class="m-0 p-0 text-center" variant="outline-secondary"
                        @click="KFK.shareDoc(data.item, data.index, $event.target)">
                        <b-icon icon="box-arrow-up" size=" sm" />
                      </b-button>
                    </template>
                    <template v-slot:cell(operation)="data">
                      <div v-if="data.item.owner===model.cocouser.userid">
                        <b-button size="sm" class="m-0 p-0" variant="outline-danger"
                          @click="deleteDocItem(data.item, data.index, $event.target)" variant="outline-primary">
                          <b-icon icon="trash"></b-icon>
                        </b-button>
                      </div>
                    </template>
                    <template v-slot:cell(owner)="data">
                      <div v-if="data.item.ownerAvatar">
                        <img :src="data.item.ownerAvatarSrc" style="width:18px; height:18px;" />
                        {{data.item.ownerName}}
                      </div>
                      <div v-else class="roundInitial">
                        {{data.item.ownerName}}
                      </div>
                    </template>
                    <template v-slot:cell()="data">
                      {{ data.value }}
                    </template>
                  </b-table>
                  <div>
                    <b-pagination class="justify-content-center" v-model="model.currentDocPage" :total-rows="doccount"
                      :per-page="model.perPage" aria-controls="my-doc-table" pills></b-pagination>
                  </div>
                </div>
              </b-tab>
            </b-tabs>
          </b-card>
          <b-row>
            <b-col class="text-center mt-5 pt-5">
              <a href="#" v-if="model.isDemoEnv" class="card-link"
                @click="KFK.upgradeToStartAccount">当前为演示账户，注册为正式用户，以便享有更多功能<BR>
                注册正式用户成功时，你之前已拥有的内容将自动迁移到你的正式用户名下 </a>
            </b-col>
          </b-row>
        </div>
        <b-modal @shown="focusOnPwdInput" @ok="KFK.getDocPwd" @hide="KFK.onDocPwdHidden" @close="KFK.cancelDocPwd"
          @cancel="KFK.cancelDocPwd" v-model="show.dialog.inputDocPasswordDialog" title="请输入协作码" button-size="sm"
          centered size="md">
          <b-container>
            <b-row>
              <b-col cols="4">协作码</b-col>
              <b-col cols="8">
                <b-form-input trim :type="model.hidepassword?'password':'text'" v-model="model.opendocpwd"
                  ref="focusThis">
                </b-form-input>
              </b-col>
            </b-row>
            <b-row>
              <b-col cols="4">&nbsp;</b-col>
              <b-col md="auto" cols="8" class="text-left align-middle">
                <b-button @click="toggleHidePassword" variant="outline-none">
                  <b-icon scale="1.5" :icon="model.hidepassword?'eye':'eye-slash'" />
                </b-button>
              </b-col>
            </b-row>
          </b-container>
        </b-modal>
        <b-modal @shown="focusOnOldPwdInput" @ok="KFK.resetDocPwd" v-model="show.dialog.resetDocPasswordDialog"
          title="设置协作密码" button-size="sm" centered size="md">
          <b-container>
            <b-row>
              <b-col cols="4">原协作码</b-col>
              <b-col cols="8">
                <b-form-input trim :type="model.hidepassword?'password':'text'" v-model="model.docOldPwd"
                  ref="focusOldPwd">
                </b-form-input>
              </b-col>
              <b-col cols="4">新协作码</b-col>
              <b-col cols="8">
                <b-form-input trim :type="model.hidepassword?'password':'text'" v-model="model.docNewPwd">
                </b-form-input>
              </b-col>
              <b-col cols="4">&nbsp;</b-col>
              <b-col cols="8">
                <b-button @click="toggleHidePassword" variant="outline-none">
                  <b-icon scale="1.5" :icon="model.hidepassword?'eye':'eye-slash'" />
                </b-button>
              </b-col>
            </b-row>
            <a href="#" class="card-link" @click="KFK.toggleFromResetToRemovePwd">&lt; 如忘记原协作码，可输入用户密码予以清除</a>
          </b-container>
        </b-modal>
        <b-modal @shown="focusOnUserPwdInput" @ok="KFK.removeDocPwd" v-model="show.dialog.userPasswordDialog"
          title="请输入你的用户密码" button-size="sm" centered size="md">
          <b-container>
            <b-row>
              <b-col cols="4">密码</b-col>
              <b-col cols="8">
                <b-form-input trim :type="model.hidepassword?'password':'text'" v-model="model.inputUserPwd"
                  ref="focusUserPwd">
                </b-form-input>
              </b-col>
              <b-col cols="4">&nbsp;</b-col>
              <b-col cols="8">
                <b-button @click="toggleHidePassword" variant="outline-none">
                  <b-icon scale="1.5" :icon="model.hidepassword?'eye':'eye-slash'" />
                </b-button>
              </b-col>
            </b-row>
          </b-container>
        </b-modal>
        <b-modal @ok="KFK.copyDoc" v-model="show.dialog.copyDocDialog" title="拷贝白板" button-size="sm" centered size="md">
          <b-container>
            <b-form>
              <b-form-group label-cols="3" label-align="right" label="新白板名" label-for="docName">
                <b-form-input id="docName" trim v-model="model.copyToDocName" :state="copyToDocNameState"
                  class="mb-2 mr-sm-2 mb-sm-0" placeholder=""></b-form-input>
                <b-form-invalid-feedback id="docName-feedback">
                  名称为3个以上英文或中文字符，不超过20个
                </b-form-invalid-feedback>
              </b-form-group>
              <b-form-group label-cols="3" label-align="right" label="拷贝到项目" label-for="docPrj">
                <b-form-select id="docPrj" v-model="model.copyToPrjId" :options="prjListOptions">
                  <template v-slot:first>
                    <b-form-select-option :value="null" disabled>-- 请选择项目 --</b-form-select-option>
                  </template>
                </b-form-select>
              </b-form-group>
              <b-form-group v-if="model.showCopyOrMove" label-cols="3" label-align="right" label=""
                label-for="checkbox-1">
                <b-form-checkbox id="checkbox-1" v-model="model.check.copyOrMove" name="checkbox-1" value="move"
                  unchecked-value="copy">
                  移动文档到新项目
                </b-form-checkbox>
              </b-form-group>
            </b-form>
          </b-container>
        </b-modal>
        <b-modal id="modal-setuserprofile" @ok="KFK.setUserProfile" v-model="show.dialog.setProfileDialog" title="用户信息"
          button-size="sm" centered size="md">
          <b-container class="my-3 ">
            <b-form autocomplete="off" class="w-100 px-2" @submit.stop.prevent="KFK.handleProfileSubmit">
              <b-form-group label-cols=3 label="显示名" label-for="profile_name" label-align="right">
                <b-form-input id="profile_name" trim v-model="model.profileToSet.name" :state="state.profile.name"
                  class="mb-2 mr-sm-2 mb-sm-0" required placeholder="新显示名" class="w-50"></b-form-input>
                <b-form-invalid-feedback id="profile_name-feedback">
                  2-10个英文/数字/汉字
                </b-form-invalid-feedback>
              </b-form-group>
              <b-form-group label-cols=3 label="原密码" label-for="profile_oldpwd" label-align="right">
                <b-form-input id="profile_oldpwd" trim :type="model.hidepassword?'password':'text'"
                  v-model="model.profileToSet.oldpwd" :state="state.profile.oldpwd" class="mb-2 mr-sm-2 mb-sm-0"
                  required class="w-50"></b-form-input>
                <b-form-invalid-feedback id="profile_oldpwd-feedback">
                  密码至少8字符，<BR>必须含大小写字母数字和特殊字符
                </b-form-invalid-feedback>
              </b-form-group>
              <b-form-group label-cols=3 label="新密码" label-for="profile_newpwd" label-align="right">
                <b-form-input id="profile_newpwd" trim :type="model.hidepassword?'password':'text'"
                  v-model="model.profileToSet.newpwd" :state="state.profile.newpwd" class="mb-2 mr-sm-2 mb-sm-0"
                  required class="w-50"></b-form-input>
                <b-form-invalid-feedback id="profile_newpwd-feedback">
                  密码至少8字符，<BR>必须含大小写字母数字和特殊字符
                </b-form-invalid-feedback>
              </b-form-group>
              <b-form-group label-cols=3 label="再输入一遍" label-for="profile_newpwd2" label-align="right">
                <b-form-input id="profile_newpwd2" trim :type="model.hidepassword?'password':'text'"
                  v-model="model.profileToSet.newpwd" :state="state.profile.newpwd2" class="mb-2 mr-sm-2 mb-sm-0"
                  required class="w-50"></b-form-input>
                <b-form-invalid-feedback id="profile_newpwd2-feedback">
                  新密码两次输入必须一样
                </b-form-invalid-feedback>
              </b-form-group>
              <b-row>
                <b-col cols="3"> 选择头像 </b-col>
                <b-col cols="9" class="text-right">
                  <b-button @click="toggleHidePassword" variant="outline-none">
                    <b-icon scale="1.5" :icon="model.hidepassword?'eye':'eye-slash'" />
                  </b-button>
                </b-col>
              </b-row>
              <div class="w-100" display="inline" style="white-space:nowrap; overflow-x:scroll; overflow-y:hidden; ">
                <b-button variant="light" size="lg" class="mx-1" @click='KFK.setProfileAvatar(avatar.id)'
                  v-for="avatar in model.avatars" v-bind:key="avatar.id">
                  <img :src="avatar.src" style="width:48px; height:48px" />
                </b-button>
              </div>
            </b-form>
          </b-container>
        </b-modal>

      </div> <!-- explorer inner -->
      <div id="gotodesignercontrol" v-show="model.docLoaded" class="padlayout noshow">
        <b-button-group class="coco">
          <b-button id="goto_designer" variant="outline-success" @click="KFK.gotoDesigner">
            <b-icon icon="pencil"></b-icon>
          </b-button>
        </b-button-group>
      </div>
    </div> <!-- explorer -->
    <div id="minimap" v-show="show.section.designer && show.section.minimap"></div>
    <div id="share" v-show="show.form.share" class="shareItContainer py-2 text-center" style="display:none;">
      <b-card :title="'分享文档 ' + model.docNameToShare">
        <b-card-text>
          点击下面的分享按钮后，<BR> 到任何沟通工具中粘贴，<BR>把URL给到协作人即可<BR>
          如果该文档已设置分享码，<BR>打开时需要提供分享码
        </b-card-text>
        <b-button id="shareit" class="shareit" variant="outline-success" @click="KFK.shareDone">
          <b-icon icon="box-arrow-up" scale=2></b-icon>
        </b-button>
      </b-card>
    </div>
    <b-modal @ok="KFK.pasteContent" v-model="show.dialog.pasteContentDialog" title="请选择显示方式" button-size="sm" centered
      size="md">
      <b-container>
        <b-row v-show="model.paste.showcontent">
          <b-col cols="12">粘贴内容
            <b-form-input disabled trim type="text" v-model="model.paste.content"> </b-form-input>
          </b-col>
        </b-row>
        <b-row v-show="model.paste.showdisplay">
          <b-col cols="12">显示文字
            <b-form-input trim type="text" v-model="model.paste.display"> </b-form-input>
          </b-col>
        </b-row>
        <b-row>
          <b-col cols="12">
            是否显示边框及底色
          </b-col>
          <b-col cols="4">
            <b-form-radio v-model="model.paste.box" name="box-radios" value="none">无</b-form-radio>
          </b-col>
          <b-col cols="4">
            <b-form-radio v-model="model.paste.box" name="box-radios" value="border">仅边框</b-form-radio>
          </b-col>
          <b-col cols="4">
            <b-form-radio v-model="model.paste.box" name="box-radios" value="all">边框及底色</b-form-radio>
          </b-col>
          </b-col>
        </b-row>
      </b-container>
    </b-modal>
  </div>
  <!--app-->
  <div id="copydiv" style="display: none; z-index: -99999"></div>
  <div id="centerpoint" class="centerpoint noshow"></div>
  <script src="./pad.js"></script>
</body>

</html>